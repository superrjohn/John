<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>ä¸€åˆ‡éƒ½æ˜¯éç¨‹ â€¢ Posts by &#34;æ”¯ä»˜&#34; tag</title>
        <link>https://superrjohn.github.io/John</link>
        <description></description>
        <language>zh-TW</language>
        <pubDate>Wed, 08 Nov 2023 17:27:06 +0800</pubDate>
        <lastBuildDate>Wed, 08 Nov 2023 17:27:06 +0800</lastBuildDate>
        <category>code</category>
        <category>SpringSecurity</category>
        <category>docker</category>
        <category>hexo</category>
        <category>æ”¯ä»˜</category>
        <category>RabbitMQ</category>
        <category>Radis</category>
        <category>SpringMVC</category>
        <category>Pinia</category>
        <category>Vue2</category>
        <category>SpringBoot</category>
        <item>
            <guid isPermalink="true">https://superrjohn.github.io/John/2023/11/08/java/pay/alipay</guid>
            <title>æ•´åˆæ”¯ä»˜å¯¶</title>
            <link>https://superrjohn.github.io/John/2023/11/08/java/pay/alipay</link>
            <category>æ”¯ä»˜</category>
            <pubDate>Wed, 08 Nov 2023 17:27:06 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;åœ¨æ­¤ç‰¹åˆ«æ„Ÿè¬é»‘é¦¬ç¨‹åºå“¡æä¾›çš„èª²ç¨‹: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWo4NDExTjdCbS8=&#34;&gt;å­¸æˆåœ¨ç·š&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å‰è¨€&lt;br&gt;
æ–¼ç”±å¯¦ç¿’é …ç›®å¿«åšå®Œæ‰åšè¨˜éŒ„ï¼Œè€Œä¸”é …ç›®æ¨¡å¡Šè¼ƒå¤šï¼Œæ•…æŒ‘éƒ¨ä»½ä¾†è¨˜éŒ„&lt;br&gt;
&lt;span class=&#34;rainbow&#34;&gt;å®Œæ•´é¡¹ç›®åœ°å€&lt;/span&gt;ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3N1cGVycmpvaG4vamF2YV93ZWI=&#34;&gt;https://github.com/superrjohn/java_web&lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&#34;æ•´åˆç¬¬ä¸‰æ–¹æ”¯ä»˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ•´åˆç¬¬ä¸‰æ–¹æ”¯ä»˜&#34;&gt;#&lt;/a&gt; æ•´åˆç¬¬ä¸‰æ–¹æ”¯ä»˜&lt;/h1&gt;
&lt;h2 id=&#34;åŸ·è¡Œæµç¨‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#åŸ·è¡Œæµç¨‹&#34;&gt;#&lt;/a&gt; åŸ·è¡Œæµç¨‹&lt;/h2&gt;
&lt;p&gt;ç”¨æˆ¶å»å­¸ç¿’æ”¶è²»èª²ç¨‹æ™‚å¼•å°å…¶å»æ”¯ä»˜ï¼Œå¦‚ä¸‹åœ–ï¼š&lt;br&gt;
ç•¶ä½¿ç”¨è€…é»æ“Šå¾®ä¿¡æ”¯ä»˜æˆ–æ”¯ä»˜å¯¶æ”¯ä»˜æ™‚åŸ·è¡Œæµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;img data-src=&#34;/John/img/java/pay/alipay/1.png&#34; class=&#34;abc&#34;&gt;
&lt;p&gt;1ï¸âƒ£è«‹æ±‚å­¸ç¿’ä¸­å¿ƒæœå‹™å»ºç«‹é¸èª²è¨˜éŒ„&lt;br&gt;
2ï¸âƒ£è«‹æ±‚è¨‚å–®æœå‹™å»ºç«‹å•†å“è¨‚å–®ã€ç”¢ç”Ÿæ”¯ä»˜äºŒç¶­ç¢¼ã€‚&lt;br&gt;
3ï¸âƒ£ç”¨æˆ¶æƒç¢¼è«‹æ±‚è¨‚å–®æ”¯ä»˜æœå‹™ï¼Œè¨‚å–®æ”¯ä»˜æœå‹™è«‹æ±‚ç¬¬ä¸‰æ–¹æ”¯ä»˜å¹³å°ç”¢ç”Ÿæ”¯ä»˜è¨‚å–®ã€‚&lt;br&gt;
4ï¸âƒ£å‰ç«¯å–šèµ·æ”¯ä»˜å®¢æˆ¶ç«¯ï¼Œä½¿ç”¨è€…è¼¸å…¥å¯†ç¢¼å®Œæˆä»˜æ¬¾ã€‚&lt;br&gt;
5ï¸âƒ£ç¬¬ä¸‰æ–¹æ”¯ä»˜å¹³å°æ”¯ä»˜å®Œæˆç™¼èµ·æ”¯ä»˜é€šçŸ¥ã€‚&lt;br&gt;
6ï¸âƒ£è¨‚å–®æ”¯ä»˜æœå‹™æ¥æ”¶ç¬¬ä¸‰æ–¹æ”¯ä»˜é€šçŸ¥çµæœã€‚&lt;br&gt;
7ï¸âƒ£ç”¨æˆ¶åœ¨å‰ç«¯æŸ¥è©¢ä»˜æ¬¾çµæœï¼Œè«‹æ±‚è¨‚å–®æ”¯ä»˜æœå‹™æŸ¥è©¢æ”¯ä»˜çµæœã€‚&lt;br&gt;
8ï¸âƒ£è¨‚å–®æ”¯ä»˜æœå‹™å‘å­¸ç¿’ä¸­å¿ƒæœå‹™é€šçŸ¥æ”¯ä»˜çµæœã€‚&lt;br&gt;
9ï¸âƒ£å­¸ç¿’ä¸­å¿ƒæœå‹™æ”¶åˆ°ä»˜æ¬¾çµæœï¼Œå¦‚æœæ”¯ä»˜æˆåŠŸå‰‡æ›´æ–°é¸èª²è¨˜éŒ„ï¼Œä¸¦æ·»åŠ åˆ°æˆ‘çš„èª²ç¨‹è¡¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é€šç”¨è¨‚å–®æœå‹™è¨­è¨ˆ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#é€šç”¨è¨‚å–®æœå‹™è¨­è¨ˆ&#34;&gt;#&lt;/a&gt; é€šç”¨è¨‚å–®æœå‹™è¨­è¨ˆ&lt;/h2&gt;
&lt;p&gt;åœ¨æœ¬é …ç›®ä¸­ä¸åƒ…é¸èª²éœ€è¦ä¸‹å–®ï¼Œè³¼è²·å­¸ç¿’è³‡æ–™ã€è€å¸«ä¸€å°ä¸€ç­”ç–‘ç­‰æ‰€æœ‰æ”¶è²»é …ç›®éƒ½éœ€è¦æ”¯ä»˜ä¸‹å–®&lt;br&gt;
æ‰€ä»¥æœ¬é …ç›®è¨­è¨ˆé€šç”¨çš„è¨‚å–®æœå‹™ï¼Œé€šç”¨çš„è¨‚å–®æœå‹™æ‰¿æ¥å„æ¥­å‹™æ¨¡çµ„çš„æ”¶è²»æ”¯ä»˜éœ€æ±‚ï¼Œç•¶ç”¨æˆ¶éœ€è¦äº¤è²»æ™‚ï¼Œçµ±ä¸€ç”¢ç”Ÿå•†å“è¨‚å–®é€²è¡Œæ”¯ä»˜&lt;br&gt;
æ‰€æœ‰æ”¶è²»æ¥­å‹™æœ€çµ‚è½‰æ›ç‚ºè¨‚å–®è¨˜éŒ„ï¼Œåœ¨è¨‚å–®æœå‹™çš„å•†å“è¨‚å–®è¡¨ä¸­å­˜å„²&lt;br&gt;
ä»¥é¸èª²ç‚ºä¾‹ï¼Œé¸èª²è¨˜éŒ„è¡¨çš„ ID åœ¨å•†å“è¨‚å–®è¡¨çš„ out_business_id å­—æ®µ&lt;/p&gt;
&lt;h1 id=&#34;æº–å‚™é–‹ç™¼ç’°å¢ƒ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æº–å‚™é–‹ç™¼ç’°å¢ƒ&#34;&gt;#&lt;/a&gt; æº–å‚™é–‹ç™¼ç’°å¢ƒ&lt;/h1&gt;
&lt;h2 id=&#34;æ”¯ä»˜å¯¶é–‹ç™¼ç’°å¢ƒ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ”¯ä»˜å¯¶é–‹ç™¼ç’°å¢ƒ&#34;&gt;#&lt;/a&gt; æ”¯ä»˜å¯¶é–‹ç™¼ç’°å¢ƒ&lt;/h2&gt;
&lt;p&gt;1ï¸âƒ£é…ç½®æ²™ç®±ç’°å¢ƒ&lt;br&gt;
æ²™ç®±ç’°å¢ƒæ˜¯æ”¯ä»˜å¯¶é–‹æ”¾å¹³å°ç‚ºé–‹ç™¼è€…æä¾›çš„èˆ‡ç”Ÿç”¢ç’°å¢ƒå®Œå…¨éš”é›¢çš„è¯èª¿æ¸¬è©¦ç’°å¢ƒï¼Œé–‹ç™¼è€…åœ¨æ²™ç®±ç’°å¢ƒä¸­å®Œæˆçš„æ¥å£å‘¼å«ä¸æœƒå°ç”Ÿç”¢ç’°å¢ƒä¸­çš„è³‡æ–™é€ æˆä»»ä½•å½±éŸ¿ã€‚&lt;br&gt;
æ¥å…¥æ‰‹æ©Ÿç¶²ç«™æ”¯ä»˜éœ€å…·å‚™ä»¥ä¸‹æ¢ä»¶ï¼š&lt;/p&gt;
&lt;p&gt;ğŸ”´ç”³è«‹å‰å¿…é ˆæ“æœ‰ç¶“éå¯¦åèªè­‰çš„æ”¯ä»˜å¯¶å¸³æˆ¶ï¼›&lt;/p&gt;
&lt;p&gt;ğŸ”´ä¼æ¥­æˆ–å€‹é«”å·¥å•†æˆ¶å¯ç”³è«‹ï¼›&lt;/p&gt;
&lt;p&gt;ğŸ”´éœ€æä¾›çœŸå¯¦æœ‰æ•ˆçš„ç‡Ÿæ¥­åŸ·ç…§ï¼Œä¸”æ”¯ä»˜å¯¶å¸³æˆ¶åç¨±éœ€èˆ‡ç‡Ÿæ¥­åŸ·ç…§ä¸»é«”ä¸€è‡´ï¼›&lt;/p&gt;
&lt;p&gt;ğŸ”´ç¶²ç«™èƒ½æ­£å¸¸å­˜å–ä¸”é é¢é¡¯ç¤ºå®Œæ•´ï¼Œç¶²ç«™éœ€è¦æ˜ç¢ºç¶“ç‡Ÿå…§å®¹ä¸”æœ‰å®Œæ•´çš„å•†å“è³‡è¨Šï¼›&lt;/p&gt;
&lt;p&gt;ğŸ”´ç¶²ç«™å¿…é ˆé€é ICP å‚™æ¡ˆã€‚ å¦‚ç‚ºå€‹é«”å·¥å•†æˆ¶ï¼Œç¶²ç«™å‚™æ¡ˆä¸»é«”éœ€èˆ‡æ”¯ä»˜å¯¶å¸³æˆ¶ä¸»é«”åç¨±ä¸€è‡´ï¼›&lt;/p&gt;
&lt;p&gt;è©³ç´°åƒè€ƒï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9kb2NzLm9wZW4uYWxpcGF5LmNvbS8yMDM=&#34;&gt;https://docs.open.alipay.com/203&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡æª”ä½¿ç”¨æ”¯ä»˜å¯¶æ²™ç®±é€²è¡Œé–‹ç™¼æ¸¬è©¦ï¼Œé€™è£¡ä¸»è¦ä»‹ç´¹æ”¯ä»˜å¯¶æ²™ç®±ç’°å¢ƒé…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;è©³ç´°åƒè€ƒï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9kb2NzLm9wZW4uYWxpcGF5LmNvbS8yMDAvMTA1MzExLw==&#34;&gt;https://docs.open.alipay.com/200/105311/&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;2ï¸âƒ£æ¨¡æ“¬å™¨&lt;/p&gt;
&lt;p&gt;ä¸‹è¼‰æ¨¡æ“¬å™¨ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL211bXUuMTYzLmNvbS8=&#34;&gt;http://mumu.163.com/&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å®‰è£æ¨¡æ“¬å™¨ï¼Œå®‰è£åœ¨æ²’æœ‰ç©ºæ ¼å’Œä¸­æ–‡çš„ç›®éŒ„ã€‚&lt;/p&gt;
&lt;p&gt;å®‰è£æˆåŠŸï¼Œå•Ÿå‹•æ¨¡æ“¬å™¨&lt;/p&gt;
&lt;p&gt;3ï¸âƒ£åœ¨æ¨¡æ“¬å™¨ä¸­å®‰è£æ²™ç®±ç‰ˆæœ¬çš„æ”¯ä»˜å¯¶&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨æ²™ç®±ç’°å¢ƒçš„è²·å®¶å¸³è™Ÿç™»å…¥æ²™ç®±ç‰ˆæœ¬çš„æ”¯ä»˜å¯¶&lt;/p&gt;
&lt;img data-src=&#34;/John/img/java/pay/alipay/2.png&#34; class=&#34;abc&#34;&gt;
&lt;h1 id=&#34;å»ºç«‹è¨‚å–®æœå‹™&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å»ºç«‹è¨‚å–®æœå‹™&#34;&gt;#&lt;/a&gt; å»ºç«‹è¨‚å–®æœå‹™&lt;/h1&gt;
&lt;p&gt;æ‹·è²èª²ç¨‹è³‡æ–™ç›®éŒ„ä¸‹çš„è¨‚å–®æœå‹™å·¥ç¨‹ xuecheng-plus-orders åˆ°è‡ªå·±çš„å·¥ç¨‹ç›®éŒ„&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œåœ¨ nacos ä¸­æ·»åŠ é…ç½®æ–‡ä»¶&lt;br&gt;
 orders-api-dev.yaml&lt;/p&gt;
&lt;figure class=&#34;highlight yaml&#34;&gt;&lt;figcaption&gt;&lt;span&gt;yaml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attr&#34;&gt;server:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;attr&#34;&gt;servlet:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;context-path:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;/orders&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;attr&#34;&gt;port:&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;63030&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attr&#34;&gt;spring:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;attr&#34;&gt;cloud:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;attr&#34;&gt;config:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;override-none:&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;orders-service-dev.yaml&lt;/p&gt;
&lt;figure class=&#34;highlight yaml&#34;&gt;&lt;figcaption&gt;&lt;span&gt;yaml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attr&#34;&gt;spring:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;attr&#34;&gt;datasource:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;driver-class-name:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;com.mysql.cj.jdbc.Driver&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;url:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;jdbc:mysql://localhost:3306/xc_orders?serverTimezone=UTC&amp;amp;userUnicode=true&amp;amp;useSSL=false&amp;amp;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;username:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;root&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;password:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;root&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attr&#34;&gt;xxl:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;attr&#34;&gt;job:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;admin:&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;attr&#34;&gt;addresses:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;http://192.168.101.128:18088/xxl-job-admin/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;executor:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;attr&#34;&gt;appname:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;payresultnotify-job&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;attr&#34;&gt;address:&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;attr&#34;&gt;ip:&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;attr&#34;&gt;port:&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;8989&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;attr&#34;&gt;logpath:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;/data/applogs/xxl-job/jobhandler&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;attr&#34;&gt;logretentiondays:&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;30&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;accessToken:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;default_token&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å»ºç«‹ xc_orders è³‡æ–™åº«ï¼Œå°å…¥é»‘é¦¬æä¾›çš„ SQL è…³æœ¬&lt;/p&gt;
&lt;h1 id=&#34;æ”¯ä»˜æ¥å£æ¸¬è©¦&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ”¯ä»˜æ¥å£æ¸¬è©¦&#34;&gt;#&lt;/a&gt; æ”¯ä»˜æ¥å£æ¸¬è©¦&lt;/h1&gt;
&lt;h2 id=&#34;é–±è®€æ¥å£å®šç¾©&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#é–±è®€æ¥å£å®šç¾©&#34;&gt;#&lt;/a&gt; é–±è®€æ¥å£å®šç¾©&lt;/h2&gt;
&lt;p&gt;1. æ‰‹æ©Ÿç¶²ç«™æ”¯ä»˜æ¥å–æµç¨‹è©³ç´°åƒè€ƒï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9kb2NzLm9wZW4uYWxpcGF5LmNvbS8yMDMvMTA1Mjg1Lw==&#34;&gt;https://docs.open.alipay.com/203/105285/&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;1ï¸âƒ£ç”¨æˆ¶åœ¨å•†å®¶çš„ H5 ç¶²ç«™ä¸‹å–®ä»˜æ¬¾å¾Œï¼Œå•†å®¶ç³»çµ±ä¾ç…§æ‰‹æ©Ÿç¶²ç«™æ”¯ä»˜æ¥å£ alipay.trade.wap.payAPI çš„åƒæ•¸è¦æ ¼ç”¢ç”Ÿè¨‚å–®æ•¸æ“š&lt;/p&gt;
&lt;p&gt;2ï¸âƒ£å‰ç«¯é é¢é€é Form è¡¨å–®çš„å½¢å¼è«‹æ±‚åˆ°æ”¯ä»˜å¯¶ã€‚ æ­¤æ™‚æ”¯ä»˜å¯¶æœƒè‡ªå‹•å°‡é é¢è·³åˆ°æ”¯ä»˜å¯¶ H5 æ”¶éŠ€å°é é¢ï¼Œå¦‚æœç”¨æˆ¶æ‰‹æ©Ÿä¸Šå®‰è£äº†æ”¯ä»˜å¯¶ APPï¼Œå‰‡æœƒè‡ªå‹•å–šèµ·æ”¯ä»˜å¯¶ APPã€‚&lt;/p&gt;
&lt;p&gt;3ï¸âƒ£è¼¸å…¥æ”¯ä»˜å¯†ç¢¼å®Œæˆä»˜æ¬¾ã€‚&lt;/p&gt;
&lt;p&gt;4ï¸âƒ£ç”¨æˆ¶åœ¨æ”¯ä»˜å¯¶ APP æˆ– H5 æ”¶éŠ€å°å®Œæˆä»˜æ¬¾å¾Œï¼Œæœƒæ ¹æ“šå•†å®¶åœ¨æ‰‹æ©Ÿç¶²ç«™æ”¯ä»˜ API ä¸­å‚³å…¥çš„å‰å°å›è·³åœ°å€ return_url è‡ªå‹•è·³è½‰å›å•†å®¶é é¢ï¼ŒåŒæ™‚åœ¨ URL è«‹æ±‚ä¸­ä»¥ Query String çš„å½¢å¼é™„å¸¶ æ”¯ä»˜çµæœåƒæ•¸ï¼Œè©³ç´°å›è·³åƒæ•¸è«‹è¦‹ã€Œæ‰‹æ©Ÿç¶²ç«™æ”¯ä»˜æ¥å£ alipay.trade.wap.payã€å‰å°å›è·³åƒæ•¸ã€‚&lt;/p&gt;
&lt;p&gt;5ï¸âƒ£æ”¯ä»˜å¯¶ä¹Ÿæœƒæ ¹æ“šåŸå§‹æ”¯ä»˜ API ä¸­å‚³å…¥çš„éåŒæ­¥é€šçŸ¥åœ°å€ notify_urlï¼Œé€é POST è«‹æ±‚çš„å½¢å¼å°‡æ”¯ä»˜çµæœä½œç‚ºåƒæ•¸é€šçŸ¥åˆ°å•†å®¶ç³»çµ±ï¼Œè©³æƒ…è«‹åƒé–±æ”¯ä»˜çµæœéåŒæ­¥é€šçŸ¥ã€‚&lt;/p&gt;
&lt;p&gt;2ã€æ¥å£å®šç¾©&lt;/p&gt;
&lt;p&gt;æ–‡æª”ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9vcGVuZG9jcy5hbGlwYXkuY29tL29wZW4vMjAzLzEwNzA5MA==&#34;&gt;https://opendocs.alipay.com/open/203/107090&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ¥å£å®šç¾©ï¼šå¤–éƒ¨å•†å®¶è¦æ±‚æ”¯ä»˜å¯¶å»ºç«‹è¨‚å–®ä¸¦æ”¯ä»˜&lt;/p&gt;
&lt;p&gt;è«‹æ±‚åœ°å€ï¼šé–‹ç™¼ä¸­ä½¿ç”¨æ²™ç®±ä½å€ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9vcGVuYXBpLmFsaXBheWRldi5jb20vZ2F0ZXdheS5kbw==&#34;&gt;https://openapi.alipaydev.com/gateway.do&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;è«‹æ±‚åƒæ•¸ï¼šè©³ç´°æŸ¥é–±&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9vcGVuZG9jcy5hbGlwYXkuY29tL29wZW4vMjAzLzEwNzA5MA==&#34;&gt; https://opendocs.alipay.com/open/203/107090&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä¸€éƒ¨åˆ†ç”± sdk è¨­ç½®ï¼Œä¸€éƒ¨åˆ†éœ€è¦ç·¨å¯«ç¨‹å¼æ™‚æŒ‡å®šã€‚&lt;/p&gt;
&lt;p&gt;3. ç¤ºä¾‹ä»£ç¢¼&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;doPost&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(HttpServletRequest httpRequest,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;                HttpServletResponse httpResponse)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; ServletException, IOException &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;AlipayClient&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;alipayClient&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; ... &lt;span class=&#34;comment&#34;&gt;//è·å¾—åˆå§‹åŒ–çš„AlipayClient&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;AlipayTradeWapPayRequest&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;alipayRequest&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;AlipayTradeWapPayRequest&lt;/span&gt;();&lt;span class=&#34;comment&#34;&gt;//åˆ›å»ºAPIå¯¹åº”çš„request&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    alipayRequest.setReturnUrl(&lt;span class=&#34;string&#34;&gt;&amp;quot;http://domain.com/CallBack/return_url.jsp&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    alipayRequest.setNotifyUrl(&lt;span class=&#34;string&#34;&gt;&amp;quot;http://domain.com/CallBack/notify_url.jsp&amp;quot;&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//åœ¨å…¬å…±å‚æ•°ä¸­è®¾ç½®å›è·³å’Œé€šçŸ¥åœ°å€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    alipayRequest.setBizContent(&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;#123;&amp;quot;&lt;/span&gt; +&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;    \&amp;quot;out_trade_no\&amp;quot;:\&amp;quot;20150320010101002\&amp;quot;,&amp;quot;&lt;/span&gt; +&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;    \&amp;quot;total_amount\&amp;quot;:88.88,&amp;quot;&lt;/span&gt; +&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;    \&amp;quot;subject\&amp;quot;:\&amp;quot;Iphone6 16G\&amp;quot;,&amp;quot;&lt;/span&gt; +&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;    \&amp;quot;product_code\&amp;quot;:\&amp;quot;QUICK_WAP_WAY\&amp;quot;&amp;quot;&lt;/span&gt; +&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;  &amp;#125;&amp;quot;&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//å¡«å……ä¸šåŠ¡å‚æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;form&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; alipayClient.pageExecute(alipayRequest).getBody(); &lt;span class=&#34;comment&#34;&gt;//è°ƒç”¨SDKç”Ÿæˆè¡¨å•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    httpResponse.setContentType(&lt;span class=&#34;string&#34;&gt;&amp;quot;text/html;charset=&amp;quot;&lt;/span&gt; + AlipayServiceEnvConstants.CHARSET);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    httpResponse.getWriter().write(form);&lt;span class=&#34;comment&#34;&gt;//ç›´æ¥å°†å®Œæ•´çš„è¡¨å•htmlè¾“å‡ºåˆ°é¡µé¢&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    httpResponse.getWriter().flush();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;ä¸‹å–®åŸ·è¡Œæµç¨‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä¸‹å–®åŸ·è¡Œæµç¨‹&#34;&gt;#&lt;/a&gt; ä¸‹å–®åŸ·è¡Œæµç¨‹&lt;/h2&gt;
&lt;p&gt;æ ¹æ“šæ¥å£æè¿°ï¼Œæ”¯ä»˜å¯¶ä¸‹å–®æ¥å£çš„åŸ·è¡Œæµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;img data-src=&#34;/John/img/java/pay/alipay/3.png&#34; class=&#34;abc&#34;&gt;
&lt;h2 id=&#34;ç·¨å¯«ä¸‹å–®ç¨‹å¼ç¢¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ç·¨å¯«ä¸‹å–®ç¨‹å¼ç¢¼&#34;&gt;#&lt;/a&gt; ç·¨å¯«ä¸‹å–®ç¨‹å¼ç¢¼&lt;/h2&gt;
&lt;p&gt;æ ¹æ“šæ¥å£æµç¨‹ï¼Œé¦–å…ˆåœ¨è¨‚å–®æœå‹™ç·¨å¯«æ¸¬è©¦é¡åˆ¥è«‹æ±‚æ”¯ä»˜å¯¶ä¸‹å–®çš„æ¥å£ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¨‚å–®æœå‹™ api å·¥ç¨‹æ·»åŠ ä¾è³´ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;figcaption&gt;&lt;span&gt;xml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;&amp;lt;!-- æ”¯ä»˜å®SDK --&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.alipay.sdk&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;alipay-sdk-java&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;3.7.73.ALL&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;&amp;lt;!-- æ”¯ä»˜å®SDKä¾èµ–çš„æ—¥å¿— --&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;commons-logging&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;commons-logging&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.2&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ‹·è² AlipayConfig.java åˆ°è¨‚å–®æœå‹™çš„ service å·¥ç¨‹ï¼Œå…¶ä¸­è«‹æ±‚ç¶²ç«™åœ°å€ç‚ºæ”¯ä»˜å¯¶æ”¯ä»˜æ¥å£åœ°å€&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;AlipayConfig&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å•†æˆ·appid&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//	public static String APPID = &amp;quot;&amp;quot;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// ç§é’¥ pkcs8æ ¼å¼çš„&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//	public static String RSA_PRIVATE_KEY = &amp;quot;&amp;quot;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æœåŠ¡å™¨å¼‚æ­¥é€šçŸ¥é¡µé¢è·¯å¾„ éœ€http://æˆ–è€…https://æ ¼å¼çš„å®Œæ•´è·¯å¾„ï¼Œä¸èƒ½åŠ ?id=123è¿™ç±»è‡ªå®šä¹‰å‚æ•°ï¼Œå¿…é¡»å¤–ç½‘å¯ä»¥æ­£å¸¸è®¿é—®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;notify_url&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;http://å•†æˆ·ç½‘å…³åœ°å€/alipay.trade.wap.pay-JAVA-UTF-8/notify_url.jsp&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// é¡µé¢è·³è½¬åŒæ­¥é€šçŸ¥é¡µé¢è·¯å¾„ éœ€http://æˆ–è€…https://æ ¼å¼çš„å®Œæ•´è·¯å¾„ï¼Œä¸èƒ½åŠ ?id=123è¿™ç±»è‡ªå®šä¹‰å‚æ•°ï¼Œå¿…é¡»å¤–ç½‘å¯ä»¥æ­£å¸¸è®¿é—® å•†æˆ·å¯ä»¥è‡ªå®šä¹‰åŒæ­¥è·³è½¬åœ°å€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;return_url&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;http://å•†æˆ·ç½‘å…³åœ°å€/alipay.trade.wap.pay-JAVA-UTF-8/return_url.jsp&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è¯·æ±‚ç½‘å…³åœ°å€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;URL&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;https://openapi.alipaydev.com/gateway.do&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// ç¼–ç &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;CHARSET&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è¿”å›æ ¼å¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;FORMAT&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;json&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ”¯ä»˜å®å…¬é’¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//	public static String ALIPAY_PUBLIC_KEY = &amp;quot;&amp;quot;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ—¥å¿—è®°å½•ç›®å½•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;log_path&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;/log&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// RSA2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;SIGNTYPE&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;RSA2&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æƒç¢¼æ”¯ä»˜å…¶å¯¦å°±æ˜¯è«‹æ±‚ URL, æ‰€ä»¥æˆ‘å€‘è¦å¯«ä¸€å€‹ Controller, æˆ‘å€‘è¦ new DefaultAlipayClient é¡ä¸¦ä¿®æ”¹åƒæ•¸&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Controller&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;PayTestController&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Value(&amp;quot;$&amp;#123;pay.alipay.APP_ID&amp;#125;&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    String APP_ID;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Value(&amp;quot;$&amp;#123;pay.alipay.APP_PRIVATE_KEY&amp;#125;&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    String APP_PRIVATE_KEY;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Value(&amp;quot;$&amp;#123;pay.alipay.ALIPAY_PUBLIC_KEY&amp;#125;&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    String ALIPAY_PUBLIC_KEY;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@RequestMapping(&amp;quot;/alipaytest&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;doPost&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(HttpServletRequest httpRequest,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;                    HttpServletResponse httpResponse)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; ServletException, IOException, AlipayApiException &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;AlipayClient&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;alipayClient&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;DefaultAlipayClient&lt;/span&gt;(AlipayConfig.URL, APP_ID, APP_PRIVATE_KEY, AlipayConfig.FORMAT, AlipayConfig.CHARSET, ALIPAY_PUBLIC_KEY,AlipayConfig.SIGNTYPE);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//è·å¾—åˆå§‹åŒ–çš„AlipayClient&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;AlipayTradeWapPayRequest&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;alipayRequest&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;AlipayTradeWapPayRequest&lt;/span&gt;();&lt;span class=&#34;comment&#34;&gt;//åˆ›å»ºAPIå¯¹åº”çš„request&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//        alipayRequest.setReturnUrl(&amp;quot;http://domain.com/CallBack/return_url.jsp&amp;quot;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//        alipayRequest.setNotifyUrl(&amp;quot;http://domain.com/CallBack/notify_url.jsp&amp;quot;);//åœ¨å…¬å…±å‚æ•°ä¸­è®¾ç½®å›è·³å’Œé€šçŸ¥åœ°å€&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        alipayRequest.setBizContent(&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;#123;&amp;quot;&lt;/span&gt; +&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;string&#34;&gt;&amp;quot;    \&amp;quot;out_trade_no\&amp;quot;:\&amp;quot;202210100010101002\&amp;quot;,&amp;quot;&lt;/span&gt; +&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;string&#34;&gt;&amp;quot;    \&amp;quot;total_amount\&amp;quot;:100000,&amp;quot;&lt;/span&gt; +&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;string&#34;&gt;&amp;quot;    \&amp;quot;subject\&amp;quot;:\&amp;quot;Iphone6 16G\&amp;quot;,&amp;quot;&lt;/span&gt; +&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;string&#34;&gt;&amp;quot;    \&amp;quot;product_code\&amp;quot;:\&amp;quot;QUICK_WAP_WAY\&amp;quot;&amp;quot;&lt;/span&gt; +&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;string&#34;&gt;&amp;quot;  &amp;#125;&amp;quot;&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//å¡«å……ä¸šåŠ¡å‚æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;form&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; alipayClient.pageExecute(alipayRequest).getBody(); &lt;span class=&#34;comment&#34;&gt;//è°ƒç”¨SDKç”Ÿæˆè¡¨å•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        httpResponse.setContentType(&lt;span class=&#34;string&#34;&gt;&amp;quot;text/html;charset=&amp;quot;&lt;/span&gt; + AlipayConfig.CHARSET);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        httpResponse.getWriter().write(form);&lt;span class=&#34;comment&#34;&gt;//ç›´æ¥å°†å®Œæ•´çš„è¡¨å•htmlè¾“å‡ºåˆ°é¡µé¢&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        httpResponse.getWriter().flush();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨ nacos ä¸­çš„ orders-service-dev.yaml ä¸­é…ç½®å…¬é’¥å’Œç§é’¥ï¼Œå¾ä½ çš„æ²™ç®±ç’°å¢ƒå¸³è™Ÿç²å¾—&lt;/p&gt;
&lt;figure class=&#34;highlight yml&#34;&gt;&lt;figcaption&gt;&lt;span&gt;yml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attr&#34;&gt;pay:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;attr&#34;&gt;alipay:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;APP_ID:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;å†™ä½ è‡ªå·±çš„AppID&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;APP_PRIVATE_KEY:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;å†™ä½ è‡ªå·±çš„åº”ç”¨ç§é’¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;ALIPAY_PUBLIC_KEY:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;å†™ä½ è‡ªå·±çš„æ”¯ä»˜å®å…¬é’¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;ç”¢ç”ŸäºŒç¶­ç¢¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ç”¢ç”ŸäºŒç¶­ç¢¼&#34;&gt;#&lt;/a&gt; ç”¢ç”ŸäºŒç¶­ç¢¼&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨è€…åœ¨å‰ç«¯ä½¿ç”¨æ”¯ä»˜å¯¶æ²™ç®±é€éæƒç¢¼è«‹æ±‚ä¸‹å–®æ¥å£ï¼Œæˆ‘å€‘éœ€è¦ç”¢ç”Ÿè¨‚å–®æœå‹™çš„ä¸‹å–®æ¥å£çš„äºŒç¶­ç¢¼ã€‚&lt;/p&gt;
&lt;p&gt;ZXing æ˜¯ä¸€å€‹é–‹æºçš„é¡åˆ¥åº«ï¼Œæ˜¯ç”¨ Java ç·¨å¯«çš„å¤šæ ¼å¼çš„ 1D / 2D æ¢ç¢¼åœ–åƒè™•ç†åº«ï¼Œä½¿ç”¨ ZXing å¯ä»¥ç”¢ç”Ÿã€è­˜åˆ¥ QR Codeï¼ˆäºŒç¶­ç¢¼ï¼‰ã€‚ å¸¸ç”¨çš„äºŒç¶­ç¢¼è™•ç†åº«é‚„æœ‰ zbarï¼Œè¿‘å¹¾å¹´ä¸å†æ›´æ–°ç¨‹å¼ç¢¼ï¼Œä¸‹é‚Šä»‹ç´¹ ZXing ç”¢ç”ŸäºŒç¶­ç¢¼çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;1ï¼‰åœ¨ base å·¥ç¨‹ pom.xml ä¸­åŠ å…¥ä¾è³´ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;figcaption&gt;&lt;span&gt;XML&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;&amp;lt;!-- äºŒç»´ç ç”Ÿæˆ&amp;amp;è¯†åˆ«ç»„ä»¶ --&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.google.zxing&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;core&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;3.3.3&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.google.zxing&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;javase&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;3.3.3&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.apache.commons&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;commons-lang3&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;2ï¼‰ç”¢ç”ŸäºŒç¶­ç¢¼æ–¹æ³•&lt;/p&gt;
&lt;p&gt;æ‹·è²èª²ç¨‹è³‡æ–™ä¸­ utils ä¸‹çš„ QRCodeUtil.java åˆ° base å·¥ç¨‹ util åŒ…ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æ¸¬è©¦æ ¹æ“šå…§å®¹ç”¢ç”ŸäºŒç¶­ç¢¼æ–¹æ³•ï¼Œåœ¨ QRCodeUtil ä¸­åŠ å…¥ main æ–¹æ³•ï¼Œç•¶åŸ·è¡Œä»£ç¢¼æ™‚æœƒç”Ÿæˆ base64 ä¸²ï¼Œå°‡ base64 ä¸²è¤‡è£½åˆ°ç€è¦½å™¨ä½å€å¾Œå°‡é¡¯ç¤ºä¸€å€‹äºŒç¶­ç¢¼ï¼Œç”¨æˆ¶ç”¨æ‰‹æ©Ÿæƒæ­¤äºŒç¶­ç¢¼å°‡è¦æ±‚è‡³&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3d3dy5pdGNhc3QuY24v&#34;&gt; http://www.itcast.cn/&lt;/span&gt; , å¦‚ä¸‹:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String[] args)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; IOException &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;QRCodeUtil&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;qrCodeUtil&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;QRCodeUtil&lt;/span&gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    System.out.println(qrCodeUtil.createQRCode(&lt;span class=&#34;string&#34;&gt;&amp;quot;http://www.itcast.cn/&amp;quot;&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;)); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;æ¥å£æ¸¬è©¦&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ¥å£æ¸¬è©¦&#34;&gt;#&lt;/a&gt; æ¥å£æ¸¬è©¦&lt;/h2&gt;
&lt;p&gt;ä¿®æ”¹æˆ‘å€‘ä¹‹å‰çš„ main æ–¹æ³•ï¼Œå°‡ url æ›æˆä¸‹å–®æ¥å£ï¼Œæ³¨æ„é€™è£¡ä¸è¦ç”¨ localhostï¼Œå¾—ç”¨æœ¬æ©Ÿå€åŸŸç¶²è·¯ ip, ç¾åœ¨ç”¨æˆ¶æƒç¢¼å¾Œæœƒè«‹æ±‚åˆ°æˆ‘å€‘å¯«çš„æ”¯ä»˜æ¥å£&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String[] args)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; IOException &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;QRCodeUtil&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;qrCodeUtil&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;QRCodeUtil&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    System.out.println(qrCodeUtil.createQRCode(&lt;span class=&#34;string&#34;&gt;&amp;quot;http://192.168.101.1:63030/orders/alipaytest&amp;quot;&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;é‹è¡Œ main æ–¹æ³•ï¼Œå¾—åˆ°äºŒç¶­ç¢¼å¾Œï¼Œé–‹å•Ÿæ¨¡æ“¬å™¨ï¼Œåœ¨æ¨¡æ“¬å™¨ä¸­é–‹å•Ÿæ”¯ä»˜å¯¶æ²™ç®±å®¢æˆ¶ç«¯ï¼Œä¸¦ä½¿ç”¨æ²™ç®±å®¢æˆ¶ç«¯æƒç”Ÿæˆçš„äºŒç¶­ç¢¼ï¼Œå°±æœƒèª¿ç”¨ SDK ç”Ÿæˆè¡¨å–®ï¼Œä¸¦å–šé†’æ”¯ä»˜å¯¶çš„ JS çª—å£&lt;/p&gt;
&lt;h1 id=&#34;æ”¯ä»˜çµæœæŸ¥è©¢æ¥å£&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ”¯ä»˜çµæœæŸ¥è©¢æ¥å£&#34;&gt;#&lt;/a&gt; æ”¯ä»˜çµæœæŸ¥è©¢æ¥å£&lt;/h1&gt;
&lt;p&gt;æ”¯ä»˜å®Œæˆå¯ä»¥å‘¼å«ç¬¬ä¸‰æ–¹æ”¯ä»˜å¹³å°çš„ä»˜æ¬¾çµæœæŸ¥è©¢æ¥å£æŸ¥è©¢æ”¯ä»˜çµæœï¼Œä»¥ä¸‹ç”¨æ¸¬è©¦é¡æŸ¥è©¢&lt;/p&gt;
&lt;p&gt;æ–‡ä»¶ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9vcGVuZG9jcy5hbGlwYXkuY29tL29wZW4vMDJpdmJ0&#34;&gt;https://opendocs.alipay.com/open/02ivbt&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å‰›æ‰è¨‚å–®ä»˜æ¬¾æˆåŠŸï¼Œå¯ä»¥ä½¿ç”¨ out_trade_no å•†å“è¨‚å–®è™Ÿç¢¼æˆ–æ”¯ä»˜å¯¶çš„äº¤æ˜“æµæ°´è™Ÿ trade_no å»æŸ¥è©¢ä»˜æ¬¾çµæœã€‚&lt;/p&gt;
&lt;p&gt;out_trade_no å•†å“è¨‚å–®è™Ÿç¢¼ï¼šæ˜¯åœ¨ä¸‹å–®è¦æ±‚æ™‚æŒ‡å®šçš„å•†å“è¨‚å–®è™Ÿç¢¼ã€‚&lt;/p&gt;
&lt;p&gt;æ”¯ä»˜å¯¶çš„äº¤æ˜“æµæ°´è™Ÿ trade_noï¼šæ˜¯æ”¯ä»˜å®Œæˆå¾Œæ”¯ä»˜å¯¶é€šçŸ¥ä»˜æ¬¾çµæœæ™‚ç™¼é€çš„ trade_no&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@SpringBootTest&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;AliPayTest&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Value(&amp;quot;$&amp;#123;pay.alipay.APP_ID&amp;#125;&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    String APP_ID; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Value(&amp;quot;$&amp;#123;pay.alipay.APP_PRIVATE_KEY&amp;#125;&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    String APP_PRIVATE_KEY; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Value(&amp;quot;$&amp;#123;pay.alipay.ALIPAY_PUBLIC_KEY&amp;#125;&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    String ALIPAY_PUBLIC_KEY; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Test&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;queryPayResult&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; AlipayApiException &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;AlipayClient&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;alipayClient&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;DefaultAlipayClient&lt;/span&gt;(AlipayConfig.URL, APP_ID, APP_PRIVATE_KEY, &lt;span class=&#34;string&#34;&gt;&amp;quot;json&amp;quot;&lt;/span&gt;, AlipayConfig.CHARSET, ALIPAY_PUBLIC_KEY, AlipayConfig.SIGNTYPE); &lt;span class=&#34;comment&#34;&gt;//è·å¾—åˆå§‹åŒ–çš„AlipayClient &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;AlipayTradeQueryRequest&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;request&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;AlipayTradeQueryRequest&lt;/span&gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;JSONObject&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;bizContent&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;JSONObject&lt;/span&gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    bizContent.put(&lt;span class=&#34;string&#34;&gt;&amp;quot;out_trade_no&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;202210100010101002&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//bizContent.put(&amp;quot;trade_no&amp;quot;, &amp;quot;2014112611001004680073956707&amp;quot;); &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    request.setBizContent(bizContent.toString()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;AlipayTradeQueryResponse&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; alipayClient.execute(request); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (response.isSuccess()) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        System.out.println(&lt;span class=&#34;string&#34;&gt;&amp;quot;è°ƒç”¨æˆåŠŸ&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;resultJson&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; response.getBody(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//è½¬map &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;Map&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;resultMap&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; JSON.parseObject(resultJson, Map.class); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;Map&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;alipay_trade_query_response&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; (Map) resultMap.get(&lt;span class=&#34;string&#34;&gt;&amp;quot;alipay_trade_query_response&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜ç»“æœ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;trade_status&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; (String) alipay_trade_query_response.get(&lt;span class=&#34;string&#34;&gt;&amp;quot;trade_status&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        System.out.println(trade_status); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        System.out.println(&lt;span class=&#34;string&#34;&gt;&amp;quot;è°ƒç”¨å¤±è´¥&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;éŸ¿æ‡‰å›ä¾†é‡è¦çš„åƒæ•¸ç‚º:&lt;br&gt;
â€œout_trade_noâ€ : â€œ20220520010101026â€,&lt;/p&gt;
&lt;p&gt;â€œtrade_noâ€:â€œ2022100422001422760505740639â€  ï¼š æ”¯ä»˜å®äº¤æ˜“æµæ°´å·&lt;/p&gt;
&lt;p&gt;â€œtotal_amountâ€ : â€œ1.30â€&lt;/p&gt;
&lt;p&gt;â€œtrade_statusâ€ : â€œTRADE_SUCCESSâ€ï¼š&lt;/p&gt;
&lt;h2 id=&#34;æ”¯ä»˜çµæœé€šçŸ¥æ¥å£&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ”¯ä»˜çµæœé€šçŸ¥æ¥å£&#34;&gt;#&lt;/a&gt; æ”¯ä»˜çµæœé€šçŸ¥æ¥å£&lt;/h2&gt;
&lt;p&gt;æº–å‚™ç’°å¢ƒ&lt;br&gt;
å°æ–¼æ‰‹æ©Ÿç¶²ç«™æ”¯ä»˜ç”¢ç”Ÿçš„äº¤æ˜“ï¼Œæ”¯ä»˜å¯¶æœƒé€šçŸ¥å•†å®¶æ”¯ä»˜çµæœï¼Œæœ‰å…©ç¨®é€šçŸ¥æ–¹å¼ï¼Œé€é return_urlã€notify_url é€²è¡Œé€šçŸ¥ï¼Œä½¿ç”¨ return_url ä¸èƒ½ä¿è­‰é€šçŸ¥åˆ°ä½ï¼Œæ¨è–¦ä½¿ç”¨ notify_url å®Œæˆæ”¯ä»˜çµæ§‹é€šçŸ¥ã€‚&lt;/p&gt;
&lt;p&gt;å…·é«”çš„ä½¿ç”¨æ–¹æ³•æ˜¯åœ¨å‘¼å«ä¸‹å–®æ¥å£çš„ API ä¸­å‚³å…¥çš„éåŒæ­¥é€šçŸ¥ä½å€ notify_urlï¼Œé€é POST è«‹æ±‚çš„å½¢å¼å°‡æ”¯ä»˜çµæœä½œç‚ºåƒæ•¸é€šçŸ¥åˆ°å•†å®¶ç³»çµ±ã€‚ è©³æƒ…å¯æŸ¥çœ‹ æ”¯ä»˜å¯¶éåŒæ­¥é€šçŸ¥èªªæ˜ ã€‚&lt;/p&gt;
&lt;p&gt;æ–‡ä»¶ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9vcGVuZG9jcy5hbGlwYXkuY29tL29wZW4vMjAzLzEwNTI4Ng==&#34;&gt;https://opendocs.alipay.com/open/203/105286&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æ“šä¸‹å–®åŸ·è¡Œæµç¨‹ï¼Œè¨‚å–®æœå‹™æ”¶åˆ°ä»˜æ¬¾çµæœéœ€è¦å°å…§å®¹é€²è¡Œé©—ç°½ï¼Œé©—ç°½æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;1ï¸âƒ£åœ¨é€šçŸ¥å›å‚³åƒæ•¸æ¸…å–®ä¸­ï¼Œé™¤å» signã€sign_type å…©å€‹åƒæ•¸å¤–ï¼Œå‡¡æ˜¯é€šçŸ¥å›å‚³å›ä¾†çš„åƒæ•¸éƒ½æ˜¯å¾…é©—ç°½çš„åƒæ•¸ã€‚ å°‡å‰©é¤˜åƒæ•¸é€²è¡Œ url_decodeï¼Œç„¶å¾Œé€²è¡Œå­—å…¸æ’åºï¼Œçµ„æˆå­—ä¸²ï¼Œå¾—åˆ°å¾…ç°½åå­—ä¸²ï¼› ç”Ÿæ´»è™ŸéåŒæ­¥é€šçŸ¥çµ„æˆçš„å¾…é©—ç°½ä¸²è£¡éœ€è¦ä¿ç•™ sign_type åƒæ•¸ã€‚&lt;/p&gt;
&lt;p&gt;2ï¸âƒ£å°‡ç°½ç« åƒæ•¸ï¼ˆsignï¼‰ä½¿ç”¨ base64 è§£ç¢¼ç‚ºå­—ç¯€ç¢¼å­—ä¸²ï¼›&lt;/p&gt;
&lt;p&gt;3ï¸âƒ£ä½¿ç”¨ RSA çš„é©—ç°½æ–¹æ³•ï¼Œé€éç°½ç« å­—ä¸²ã€ç°½ç« åƒæ•¸ï¼ˆç¶“é base64 è§£ç¢¼ï¼‰åŠæ”¯ä»˜å¯¶å…¬é‘°é©—è­‰ç°½ç« ã€‚&lt;/p&gt;
&lt;p&gt;4ï¸âƒ£é©—è­‰ç°½ç« æ­£ç¢ºå¾Œï¼Œå¿…é ˆå†åš´æ ¼ä¾ç…§ä»¥ä¸‹æè¿°æ ¡é©—é€šçŸ¥è³‡æ–™çš„æ­£ç¢ºæ€§ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸Šè¿°é©—è­‰é€šéå¾Œï¼Œå•†å®¶å¿…é ˆæ ¹æ“šæ”¯ä»˜å¯¶ä¸åŒé¡å‹çš„æ¥­å‹™é€šçŸ¥ï¼Œæ­£ç¢ºçš„é€²è¡Œä¸åŒçš„æ¥­å‹™è™•ç†ï¼Œä¸¦ä¸”éæ¿¾é‡è¤‡çš„é€šçŸ¥çµæœè³‡æ–™ã€‚&lt;/p&gt;
&lt;p&gt;é€éé©—è­‰ out_trade_noã€total_amountã€appid åƒæ•¸çš„æ­£ç¢ºæ€§ä¾†åˆ¤æ–·é€šçŸ¥è«‹æ±‚çš„åˆæ³•æ€§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç·¨å¯«æ¸¬è©¦ç¨‹å¼ç¢¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ç·¨å¯«æ¸¬è©¦ç¨‹å¼ç¢¼&#34;&gt;#&lt;/a&gt; ç·¨å¯«æ¸¬è©¦ç¨‹å¼ç¢¼&lt;/h2&gt;
&lt;p&gt;åœ¨ä¸‹å–®è«‹æ±‚æ™‚è¨­å®šé€šçŸ¥ä½å€ request.setNotifyUrl (â€œå•†å®¶è‡ªå·±çš„ notify_url ä½å€â€);&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@GetMapping(&amp;quot;/alipaytest&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;alipaytest&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(HttpServletRequest httpRequest, &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;params&#34;&gt;                           HttpServletResponse httpResponse)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; ServletException, IOException &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//æ„é€ sdkçš„å®¢æˆ·ç«¯å¯¹è±¡ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;AlipayClient&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;alipayClient&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;DefaultAlipayClient&lt;/span&gt;(serverUrl, APP_ID, APP_PRIVATE_KEY, &lt;span class=&#34;string&#34;&gt;&amp;quot;json&amp;quot;&lt;/span&gt;, CHARSET, ALIPAY_PUBLIC_KEY, sign_type); &lt;span class=&#34;comment&#34;&gt;//è·å¾—åˆå§‹åŒ–çš„AlipayClient &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;AlipayTradeWapPayRequest&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;alipayRequest&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;AlipayTradeWapPayRequest&lt;/span&gt;();&lt;span class=&#34;comment&#34;&gt;//åˆ›å»ºAPIå¯¹åº”çš„request &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//        alipayRequest.setReturnUrl(&amp;quot;http://domain.com/CallBack/return_url.jsp&amp;quot;); &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        alipayRequest.setNotifyUrl(&lt;span class=&#34;string&#34;&gt;&amp;quot;http://tjxt-user-t.itheima.net/xuecheng/orders/paynotify&amp;quot;&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//åœ¨å…¬å…±å‚æ•°ä¸­è®¾ç½®å›è·³å’Œé€šçŸ¥åœ°å€ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ..... &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;span class=&#34;yellow&#34;&gt;æ³¨æ„ç”±æ–¼å›å‘¼ä½å€å¿…é ˆå¤–ç¶²å¯å­˜å–çš„ä½å€ï¼Œæ‰€ä»¥é€™è£¡éœ€è¦å…§ç¶²ç©¿é€å·¥å…·ï¼Œå¯ä»¥ç”¨ NatApp æˆ–è€…èŠ±ç”Ÿæ®¼&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç·¨å¯«æ¥æ”¶é€šçŸ¥æ¥å£ï¼Œæ¥æ”¶åƒæ•¸ä¸¦é©—ç°½&lt;/p&gt;
&lt;p&gt;åƒè€ƒèª²ç¨‹è³‡æ–™ä¸‹çš„ alipay.trade.wap.pay-java-utf-8\WebContent\notify_url.jsp, ç¨‹å¼ç¢¼å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//æ¥æ”¶é€šçŸ¥ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@PostMapping(&amp;quot;/paynotify&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;paynotify&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(HttpServletRequest request,HttpServletResponse response)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; UnsupportedEncodingException, AlipayApiException &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Map&amp;lt;String,String&amp;gt; params = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;HashMap&lt;/span&gt;&amp;lt;String,String&amp;gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;Map&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;requestParams&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; request.getParameterMap(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;Iterator&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;iter&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; requestParams.keySet().iterator(); iter.hasNext();) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; (String) iter.next(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        String[] values = (String[]) requestParams.get(name); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;valueStr&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; values.length; i++) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            valueStr = (i == values.length - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;) ? valueStr + values[i] &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    : valueStr + values[i] + &lt;span class=&#34;string&#34;&gt;&amp;quot;,&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//ä¹±ç è§£å†³ï¼Œè¿™æ®µä»£ç åœ¨å‡ºç°ä¹±ç æ—¶ä½¿ç”¨ã€‚å¦‚æœmysignå’Œsignä¸ç›¸ç­‰ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™æ®µä»£ç è½¬åŒ– &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//valueStr = new String(valueStr.getBytes(&amp;quot;ISO-8859-1&amp;quot;), &amp;quot;gbk&amp;quot;); &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        params.put(name, valueStr); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//è·å–æ”¯ä»˜å®çš„é€šçŸ¥è¿”å›å‚æ•°ï¼Œå¯å‚è€ƒæŠ€æœ¯æ–‡æ¡£ä¸­é¡µé¢è·³è½¬åŒæ­¥é€šçŸ¥å‚æ•°åˆ—è¡¨(ä»¥ä¸Šä»…ä¾›å‚è€ƒ)// &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//è®¡ç®—å¾—å‡ºé€šçŸ¥éªŒè¯ç»“æœ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//boolean AlipaySignature.rsaCheckV1(Map&amp;lt;String, String&amp;gt; params, String publicKey, String charset, String sign_type) &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;verify_result&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; AlipaySignature.rsaCheckV1(params, ALIPAY_PUBLIC_KEY, AlipayConfig.CHARSET, &lt;span class=&#34;string&#34;&gt;&amp;quot;RSA2&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(verify_result) &amp;#123;&lt;span class=&#34;comment&#34;&gt;//éªŒè¯æˆåŠŸ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;////////////////////////////////////////////////////////////////////////////////////////// &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//è¯·åœ¨è¿™é‡ŒåŠ ä¸Šå•†æˆ·çš„ä¸šåŠ¡é€»è¾‘ç¨‹åºä»£ç  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;comment&#34;&gt;//å•†æˆ·è®¢å•å· &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;out_trade_no&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;String&lt;/span&gt;(request.getParameter(&lt;span class=&#34;string&#34;&gt;&amp;quot;out_trade_no&amp;quot;&lt;/span&gt;).getBytes(&lt;span class=&#34;string&#34;&gt;&amp;quot;ISO-8859-1&amp;quot;&lt;/span&gt;),&lt;span class=&#34;string&#34;&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜å®äº¤æ˜“å·     &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;trade_no&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;String&lt;/span&gt;(request.getParameter(&lt;span class=&#34;string&#34;&gt;&amp;quot;trade_no&amp;quot;&lt;/span&gt;).getBytes(&lt;span class=&#34;string&#34;&gt;&amp;quot;ISO-8859-1&amp;quot;&lt;/span&gt;),&lt;span class=&#34;string&#34;&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//äº¤æ˜“çŠ¶æ€ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;trade_status&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;String&lt;/span&gt;(request.getParameter(&lt;span class=&#34;string&#34;&gt;&amp;quot;trade_status&amp;quot;&lt;/span&gt;).getBytes(&lt;span class=&#34;string&#34;&gt;&amp;quot;ISO-8859-1&amp;quot;&lt;/span&gt;),&lt;span class=&#34;string&#34;&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//â€”â€”è¯·æ ¹æ®æ‚¨çš„ä¸šåŠ¡é€»è¾‘æ¥ç¼–å†™ç¨‹åºï¼ˆä»¥ä¸‹ä»£ç ä»…ä½œå‚è€ƒï¼‰â€”â€” &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (trade_status.equals(&lt;span class=&#34;string&#34;&gt;&amp;quot;TRADE_FINISHED&amp;quot;&lt;/span&gt;)) &amp;#123;&lt;span class=&#34;comment&#34;&gt;//äº¤æ˜“ç»“æŸ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//åˆ¤æ–­è¯¥ç¬”è®¢å•æ˜¯å¦åœ¨å•†æˆ·ç½‘ç«™ä¸­å·²ç»åšè¿‡å¤„ç† &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//å¦‚æœæ²¡æœ‰åšè¿‡å¤„ç†ï¼Œæ ¹æ®è®¢å•å·ï¼ˆout_trade_noï¼‰åœ¨å•†æˆ·ç½‘ç«™çš„è®¢å•ç³»ç»Ÿä¸­æŸ¥åˆ°è¯¥ç¬”è®¢å•çš„è¯¦ç»†ï¼Œå¹¶æ‰§è¡Œå•†æˆ·çš„ä¸šåŠ¡ç¨‹åº &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//è¯·åŠ¡å¿…åˆ¤æ–­è¯·æ±‚æ—¶çš„total_feeã€seller_idä¸é€šçŸ¥æ—¶è·å–çš„total_feeã€seller_idä¸ºä¸€è‡´çš„ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//å¦‚æœæœ‰åšè¿‡å¤„ç†ï¼Œä¸æ‰§è¡Œå•†æˆ·çš„ä¸šåŠ¡ç¨‹åº &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//æ³¨æ„ï¼š &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//å¦‚æœç­¾çº¦çš„æ˜¯å¯é€€æ¬¾åè®®ï¼Œé€€æ¬¾æ—¥æœŸè¶…è¿‡å¯é€€æ¬¾æœŸé™åï¼ˆå¦‚ä¸‰ä¸ªæœˆå¯é€€æ¬¾ï¼‰ï¼Œæ”¯ä»˜å®ç³»ç»Ÿå‘é€è¯¥äº¤æ˜“çŠ¶æ€é€šçŸ¥ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//å¦‚æœæ²¡æœ‰ç­¾çº¦å¯é€€æ¬¾åè®®ï¼Œé‚£ä¹ˆä»˜æ¬¾å®Œæˆåï¼Œæ”¯ä»˜å®ç³»ç»Ÿå‘é€è¯¥äº¤æ˜“çŠ¶æ€é€šçŸ¥ã€‚ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (trade_status.equals(&lt;span class=&#34;string&#34;&gt;&amp;quot;TRADE_SUCCESS&amp;quot;&lt;/span&gt;)) &amp;#123;&lt;span class=&#34;comment&#34;&gt;//äº¤æ˜“æˆåŠŸ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            System.out.println(trade_status); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//åˆ¤æ–­è¯¥ç¬”è®¢å•æ˜¯å¦åœ¨å•†æˆ·ç½‘ç«™ä¸­å·²ç»åšè¿‡å¤„ç† &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//å¦‚æœæ²¡æœ‰åšè¿‡å¤„ç†ï¼Œæ ¹æ®è®¢å•å·ï¼ˆout_trade_noï¼‰åœ¨å•†æˆ·ç½‘ç«™çš„è®¢å•ç³»ç»Ÿä¸­æŸ¥åˆ°è¯¥ç¬”è®¢å•çš„è¯¦ç»†ï¼Œå¹¶æ‰§è¡Œå•†æˆ·çš„ä¸šåŠ¡ç¨‹åº &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//è¯·åŠ¡å¿…åˆ¤æ–­è¯·æ±‚æ—¶çš„total_feeã€seller_idä¸é€šçŸ¥æ—¶è·å–çš„total_feeã€seller_idä¸ºä¸€è‡´çš„ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//å¦‚æœæœ‰åšè¿‡å¤„ç†ï¼Œä¸æ‰§è¡Œå•†æˆ·çš„ä¸šåŠ¡ç¨‹åº &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//æ³¨æ„ï¼š &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//å¦‚æœç­¾çº¦çš„æ˜¯å¯é€€æ¬¾åè®®ï¼Œé‚£ä¹ˆä»˜æ¬¾å®Œæˆåï¼Œæ”¯ä»˜å®ç³»ç»Ÿå‘é€è¯¥äº¤æ˜“çŠ¶æ€é€šçŸ¥ã€‚ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        response.getWriter().write(&lt;span class=&#34;string&#34;&gt;&amp;quot;success&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        response.getWriter().write(&lt;span class=&#34;string&#34;&gt;&amp;quot;fail&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;é€šçŸ¥æ¥å£æ¸¬è©¦&lt;/p&gt;
&lt;p&gt;1ï¸âƒ£é‡å•Ÿè¨‚å–®æœå‹™ï¼Œä¸¦åœ¨æ¥æ”¶é€šçŸ¥æ¥å£ä¸­æ‰“ä¸Šæ–·é»&lt;/p&gt;
&lt;p&gt;2ï¸âƒ£é…ç½®å…§éƒ¨ç¶²è·¯ç©¿é€çš„æœ¬åœ°ç«¯å£ç‚ºè¨‚å–®æœå‹™ç«¯å£ï¼Œå•Ÿå‹•å…§éƒ¨ç¶²è·¯ç©¿é€å®¢æˆ¶ç«¯ã€‚&lt;/p&gt;
&lt;p&gt;3ï¸âƒ£æ‰“é–‹æ¨¡æ“¬å™¨ã€æ”¯ä»˜å¯¶æ²™ç®±ï¼Œæƒç¢¼ã€ä»˜æ¬¾ã€‚&lt;/p&gt;
&lt;p&gt;4ï¸âƒ£è§€å¯Ÿæ¥æ”¶è¨‚å–®æ”¯ä»˜è³‡æ–™ç­‰æ˜¯å¦æ­£å¸¸ã€‚&lt;/p&gt;
&lt;p&gt;é€™é‡ŒæˆåŠŸé€²å…¥åˆ°äº†é€šçŸ¥æ¥å£&lt;/p&gt;
&lt;img data-src=&#34;/John/img/java/pay/alipay/4.png&#34; class=&#34;abc&#34;&gt;
&lt;h1 id=&#34;ç”Ÿæˆæ”¯ä»˜äºŒç¶­ç¢¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ç”Ÿæˆæ”¯ä»˜äºŒç¶­ç¢¼&#34;&gt;#&lt;/a&gt; ç”Ÿæˆæ”¯ä»˜äºŒç¶­ç¢¼&lt;/h1&gt;
&lt;h2 id=&#34;åŸ·è¡Œæµç¨‹-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#åŸ·è¡Œæµç¨‹-2&#34;&gt;#&lt;/a&gt; åŸ·è¡Œæµç¨‹&lt;/h2&gt;
&lt;p&gt;é»é¸ã€Œæ”¯ä»˜å¯¶æ”¯ä»˜ã€æ­¤æ™‚é–‹å•Ÿæ”¯ä»˜äºŒç¶­ç¢¼ï¼Œç”¨æˆ¶æƒç¢¼æ”¯ä»˜ã€‚&lt;/p&gt;
&lt;img data-src=&#34;/John/img/java/pay/alipay/5.png&#34; class=&#34;abc&#34;&gt;
&lt;p&gt;åŸ·è¡Œæµç¨‹ï¼š&lt;/p&gt;
&lt;p&gt;1. å‰ç«¯èª¿ç”¨å­¸ç¿’ä¸­å¿ƒæœå‹™çš„æ–°å¢é¸èª²æ¥å£ã€‚&lt;/p&gt;
&lt;p&gt;2. æ–°å¢é¸èª²æˆåŠŸè«‹æ±‚è¨‚å–®æœå‹™ç”¢ç”Ÿæ”¯ä»˜äºŒç¶­ç¢¼æ¥å£ã€‚&lt;/p&gt;
&lt;p&gt;3. ç”¢ç”ŸäºŒç¶­ç¢¼æ¥å£ï¼šå»ºç«‹å•†å“è¨‚å–®ã€ç”¢ç”Ÿæ”¯ä»˜äº¤æ˜“è¨˜éŒ„ã€ç”¢ç”ŸäºŒç¶­ç¢¼ã€‚&lt;/p&gt;
&lt;p&gt;4. å°‡äºŒç¶­ç¢¼è¿”å›å‰ç«¯ï¼Œç”¨æˆ¶æƒç¢¼ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨è€…æƒç¢¼æ”¯ä»˜æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;img data-src=&#34;/John/img/java/pay/alipay/6.png&#34; class=&#34;abc&#34;&gt;
&lt;p&gt;1. ç”¨æˆ¶è¼¸å…¥æ”¯ä»˜å¯†ç¢¼ï¼Œä»˜æ¬¾æˆåŠŸã€‚&lt;/p&gt;
&lt;p&gt;2ã€æ¥æ”¶ç¬¬ä¸‰æ–¹å¹³å°é€šçŸ¥çš„ä»˜æ¬¾çµæœã€‚&lt;/p&gt;
&lt;p&gt;3ã€æ ¹æ“šæ”¯ä»˜çµæœæ›´æ–°æ”¯ä»˜äº¤æ˜“è¨˜éŒ„çš„æ”¯ä»˜ç‹€æ…‹ç‚ºæ”¯ä»˜æˆåŠŸã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ•¸æ“šæ¨¡å‹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ•¸æ“šæ¨¡å‹&#34;&gt;#&lt;/a&gt; æ•¸æ“šæ¨¡å‹&lt;/h2&gt;
&lt;p&gt;è¨‚å–®æ”¯ä»˜æ¨¡å¼çš„æ ¸å¿ƒç”±ä¸‰å¼µè¡¨çµ„æˆï¼šè¨‚å–®è¡¨ã€è¨‚å–®æ˜ç´°è¡¨ã€æ”¯ä»˜äº¤æ˜“è¨˜éŒ„è¡¨ã€‚&lt;/p&gt;
&lt;img data-src=&#34;/John/img/java/pay/alipay/7.png&#34; class=&#34;abc&#34;&gt;
&lt;p&gt;è¨‚å–®è™Ÿç¢¼æ³¨æ„å”¯ä¸€æ€§ã€å®‰å…¨æ€§ã€ç›¡é‡çŸ­ç­‰ç‰¹é»ï¼Œç”Ÿæˆæ–¹æ¡ˆå¸¸ç”¨çš„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;1. æ™‚é–“æˆ³ + éš¨æ©Ÿæ•¸&lt;/p&gt;
&lt;p&gt;å¹´æœˆæ—¥æ™‚åˆ†ç§’æ¯«ç§’ + éš¨æ©Ÿæ•¸&lt;/p&gt;
&lt;p&gt;2ã€é«˜ä¸¦ç™¼å ´æ™¯&lt;/p&gt;
&lt;p&gt;å¹´æœˆæ—¥æ™‚åˆ†ç§’æ¯«ç§’ + éš¨æ©Ÿæ•¸ + redis è‡ªå¢åºåˆ—&lt;/p&gt;
&lt;p&gt;3. è¨‚å–®è™Ÿç¢¼ä¸­åŠ ä¸Šæ¥­å‹™æ¨™è­˜&lt;/p&gt;
&lt;p&gt;è¨‚å–®è™Ÿç¢¼åŠ ä¸Šæ¥­å‹™è­˜åˆ¥æ–¹ä¾¿å®¢æœï¼Œä¾‹å¦‚ï¼šç¬¬ 10 ä½æ˜¯æ¥­å‹™é¡å‹ï¼Œç¬¬ 11 ä½æ˜¯ä½¿ç”¨è€…é¡å‹ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;4ã€é›ªèŠ±æ¼”ç®—æ³•&lt;/p&gt;
&lt;p&gt;é›ªèŠ±æ¼”ç®—æ³•æ˜¯æ¨ç‰¹å…§éƒ¨ä½¿ç”¨çš„åˆ†æ•£å¼ç’°å¢ƒä¸‹çš„å”¯ä¸€ ID ç”Ÿæˆæ¼”ç®—æ³•ï¼Œå®ƒåŸºæ–¼æ™‚é–“æˆ³ç”Ÿæˆï¼Œä¿è­‰æœ‰åºéå¢ï¼ŒåŠ ä»¥å…¥é›»è…¦ç¡¬é«”ç­‰å…ƒç´ ï¼Œå¯ä»¥æ»¿è¶³é«˜ä¸¦ç™¼ç’°å¢ƒä¸‹ ID ä¸é‡è¤‡ã€‚&lt;br&gt;
æœ¬é …ç›®è¨‚å–®ç·¨è™Ÿç”¢ç”Ÿæ¡ç”¨é›ªèŠ±æ¼”ç®—æ³•ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬å°ˆæ¡ˆè¨‚å–®è™Ÿç¢¼ç”¢ç”Ÿç­–ç•¥æ¡ç”¨é›ªèŠ±æ¼”ç®—æ³•ï¼Œå°å…¥é»‘é¦¬æä¾›çš„ IdWorkerUtils.java åˆ° base å·¥ç¨‹çš„ utils åŒ…ä¸‹&lt;/p&gt;
&lt;h2 id=&#34;æ¥å£å®šç¾©&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ¥å£å®šç¾©&#34;&gt;#&lt;/a&gt; æ¥å£å®šç¾©&lt;/h2&gt;
&lt;p&gt;åœ¨è¨‚å–®æœå‹™ä¸­å®šç¾©ç”¢ç”Ÿæ”¯ä»˜äºŒç¶­ç¢¼æ¥å£ã€‚&lt;/p&gt;
&lt;p&gt;è«‹æ±‚ï¼šè¨‚å–®è¨Šæ¯&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Data&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@ToString&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;AddOrderDto&lt;/span&gt;  &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ€»ä»· &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; Float totalPrice; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//è®¢å•ç±»å‹ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; String orderType; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//è®¢å•åç§° &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; String orderName; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//è®¢å•æè¿° &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; String orderDescrip; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// è®¢å•æ˜ç»†jsonï¼Œä¸å¯ä¸ºç©º &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//[&amp;#123;&amp;quot;goodsId&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;goodsType&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;goodsName&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;goodsPrice&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;goodsDetail&amp;quot;:&amp;quot;&amp;quot;&amp;#125;,&amp;#123;...&amp;#125;] &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; String orderDetail; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//å¤–éƒ¨ç³»ç»Ÿä¸šåŠ¡id &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; String outBusinessId; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;éŸ¿æ‡‰ï¼šæ”¯ä»˜äº¤æ˜“è¨˜éŒ„è³‡è¨ŠåŠäºŒç¶­ç¢¼è¨Šæ¯&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Data&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@ToString&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;PayRecordDto&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;XcPayRecord&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//äºŒç»´ç  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; String qrcode; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ¥å£å®šç¾©å¦‚ä¸‹&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Api(value = &amp;quot;è®¢å•æ”¯ä»˜æ¥å£&amp;quot;, tags = &amp;quot;è®¢å•æ”¯ä»˜æ¥å£&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Slf4j&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Controller&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;OrderController&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@ApiOperation(&amp;quot;ç”Ÿæˆæ”¯ä»˜äºŒç»´ç &amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@PostMapping(&amp;quot;/generatepaycode&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@ResponseBody&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; PayRecordDto &lt;span class=&#34;title function_&#34;&gt;generatePayCode&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@RequestBody&lt;/span&gt; AddOrderDto addOrderDto)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç”¨æˆ·æ‰«ç è¯·æ±‚ä¸‹å•ï¼Œå®šä¹‰ä¸‹å•æ¥å£å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@ApiOperation(&amp;quot;æ‰«ç ä¸‹å•æ¥å£&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@GetMapping(&amp;quot;/requestpay&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;requestpay&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String payNo,HttpServletResponse httpResponse)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; IOException &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;æ¥å£å¯¦ç¾&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ¥å£å¯¦ç¾&#34;&gt;#&lt;/a&gt; æ¥å£å¯¦ç¾&lt;/h2&gt;
&lt;p&gt;åœ¨å‰é¢çš„åˆ†æä¸­ï¼Œç”¢ç”Ÿæ”¯ä»˜äºŒç¶­ç¢¼æ“ä½œï¼Œå…¶ä¸­åŒ…å«äº†ä¸‰å€‹å°æ“ä½œ&lt;br&gt;
1ï¸âƒ£æ’å…¥è¨‚å–®è¨Šæ¯&lt;br&gt;
2ï¸âƒ£æ’å…¥ä»˜æ¬¾è¨˜éŒ„&lt;br&gt;
3ï¸âƒ£ç”¢ç”ŸäºŒç¶­ç¢¼è¿”å›&lt;br&gt;
ä¸‹é‚Šè¦åšçš„å°±æ˜¯å¯¦ç¾é€™ä¸‰å€‹æ¥å£&lt;/p&gt;
&lt;p&gt;å®šç¾©ä¿å­˜è¨‚å–®è³‡è¨Šæ¥å£&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;OrderService&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;comment&#34;&gt;/** &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * &lt;span class=&#34;doctag&#34;&gt;@description&lt;/span&gt; åˆ›å»ºå•†å“è®¢å• &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * &lt;span class=&#34;doctag&#34;&gt;@param&lt;/span&gt; addOrderDto è®¢å•ä¿¡æ¯ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * &lt;span class=&#34;doctag&#34;&gt;@return&lt;/span&gt; PayRecordDto æ”¯ä»˜äº¤æ˜“è®°å½•(åŒ…æ‹¬äºŒç»´ç ) &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * &lt;span class=&#34;doctag&#34;&gt;@author&lt;/span&gt; Mr.M &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * &lt;span class=&#34;doctag&#34;&gt;@date&lt;/span&gt; 2022/10/4 11:02 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;*/&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; PayRecordDto &lt;span class=&#34;title function_&#34;&gt;createOrder&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String userId,AddOrderDto addOrderDto)&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨ä¿å­˜è¨‚å–®æ¥å£ä¸­éœ€è¦å®Œæˆå»ºç«‹å•†å“è¨‚å–®ã€å»ºç«‹æ”¯ä»˜äº¤æ˜“è¨˜éŒ„ï¼Œæ¥å£å¯¦ä½œæ–¹æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Slf4j&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Service&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;OrderServiceImpl&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;OrderService&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Autowired&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    XcOrdersMapper ordersMapper; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Autowired&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    XcOrdersGoodsMapper ordersGoodsMapper; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Autowired&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    XcPayRecordMapper payRecordMapper; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Transactional&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; PayRecordDto &lt;span class=&#34;title function_&#34;&gt;createOrder&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String userId, AddOrderDto addOrderDto)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//æ·»åŠ å•†å“è®¢å• &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//æ·»åŠ æ”¯ä»˜äº¤æ˜“è®°å½• &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//ç”ŸæˆäºŒç»´ç  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç·¨å¯«å»ºç«‹å•†å“è¨‚å–®æ–¹æ³•ï¼Œå•†å“è¨‚å–®çš„è³‡æ–™ä¾†è‡ªé¸èª²è¨˜éŒ„ï¼Œåœ¨è¨‚å–®è¡¨éœ€è¦å­˜å…¥é¸èª²è¨˜éŒ„çš„ IDï¼Œé€™è£¡éœ€è¦ä½œå¥½å†ªç­‰è™•ç†ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Transactional&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; XcOrders &lt;span class=&#34;title function_&#34;&gt;saveOrders&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String userId, AddOrderDto addOrderDto)&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 1. å¹‚ç­‰æ€§åˆ¤æ–­&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;XcOrders&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;order&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; getOrderByBusinessId(addOrderDto.getOutBusinessId());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (order != &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; order;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 2. æ’å…¥è®¢å•è¡¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    order = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;XcOrders&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    BeanUtils.copyProperties(addOrderDto, order);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    order.setId(IdWorkerUtils.getInstance().nextId());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    order.setCreateDate(LocalDateTime.now());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    order.setUserId(userId);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    order.setStatus(&lt;span class=&#34;string&#34;&gt;&amp;quot;600001&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;insert&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; xcOrdersMapper.insert(order);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (insert &amp;lt;= &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ’å…¥è®¢å•è®°å½•å¤±è´¥&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 3. æ’å…¥è®¢å•æ˜ç»†è¡¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;Long&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;orderId&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; order.getId();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;orderDetail&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; addOrderDto.getOrderDetail();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    List&amp;lt;XcOrdersGoods&amp;gt; xcOrdersGoodsList = JSON.parseArray(orderDetail, XcOrdersGoods.class);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    xcOrdersGoodsList.forEach(goods -&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        goods.setOrderId(orderId);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;insert1&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; xcOrdersGoodsMapper.insert(goods);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (insert1 &amp;lt;= &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ’å…¥è®¢å•æ˜ç»†å¤±è´¥&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; order;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//æ ¹æ®ä¸šåŠ¡idæŸ¥è¯¢è®¢å• &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; XcOrders &lt;span class=&#34;title function_&#34;&gt;getOrderByBusinessId&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String businessId)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;XcOrders&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;orders&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; ordersMapper.selectOne(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;LambdaQueryWrapper&lt;/span&gt;&amp;lt;XcOrders&amp;gt;().eq(XcOrders::getOutBusinessId, businessId)); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; orders; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;å»ºç«‹æ”¯ä»˜äº¤æ˜“è¨˜éŒ„&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å»ºç«‹æ”¯ä»˜äº¤æ˜“è¨˜éŒ„&#34;&gt;#&lt;/a&gt; å»ºç«‹æ”¯ä»˜äº¤æ˜“è¨˜éŒ„&lt;/h2&gt;
&lt;p&gt;&lt;span class=&#34;red&#34;&gt;ç‚ºä»€éº¼è¦å‰µå»ºæ”¯ä»˜äº¤æ˜“è¨˜éŒ„ï¼Ÿ&lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;åœ¨è«‹æ±‚å¾®ä¿¡æˆ–æ”¯ä»˜å¯¶ä¸‹å–®æ¥å£æ™‚éœ€è¦å‚³å…¥å•†å“è¨‚å–®è™Ÿï¼Œåœ¨èˆ‡ç¬¬ä¸‰æ–¹æ”¯ä»˜å¹³å°å°æ¥æ™‚ç™¼ç¾ï¼Œç•¶ç”¨æˆ¶æ”¯ä»˜å¤±æ•—æˆ–å› ç‚ºå…¶å®ƒåŸå› æœ€çµ‚è©²è¨‚å–®æ²’æœ‰æ”¯ä»˜æˆåŠŸï¼Œæ­¤æ™‚å†æ¬¡èª¿ç”¨ç¬¬ä¸‰æ–¹æ”¯ä»˜å¹³å°çš„ ä¸‹å–®æ¥å£ç™¼ç¾å ±éŒ¯ â€œè¨‚å–®è™Ÿç¢¼å·²å­˜åœ¨â€ï¼Œæ­¤æ™‚å¦‚æœæˆ‘å€‘å‚³å…¥ä¸€å€‹æ²’æœ‰ä½¿ç”¨éçš„è¨‚å–®è™Ÿç¢¼å°±å¯ä»¥è§£æ±ºå•é¡Œï¼Œä½†æ˜¯å•†å“è¨‚å–®å·²ç¶“å‰µå»ºï¼Œå› ç‚ºæ²’æœ‰æ”¯ä»˜æˆåŠŸé‡æ–°å‰µå»ºä¸€å€‹æ–°è¨‚å–®æ˜¯ä¸åˆç†çš„ã€‚&lt;/p&gt;
&lt;p&gt;è§£æ±ºä»¥ä¸Šå•é¡Œçš„æ–¹æ¡ˆæ˜¯ï¼š&lt;/p&gt;
&lt;p&gt;1ã€ç”¨æˆ¶æ¯æ¬¡ç™¼èµ·éƒ½å»ºç«‹ä¸€å€‹æ–°çš„æ”¯ä»˜äº¤æ˜“è¨˜éŒ„ ï¼Œæ­¤äº¤æ˜“è¨˜éŒ„èˆ‡å•†å“è¨‚å–®é—œè¯ã€‚&lt;/p&gt;
&lt;p&gt;2ã€å°‡æ”¯ä»˜äº¤æ˜“è¨˜éŒ„çš„æµæ°´è™Ÿå‚³çµ¦ç¬¬ä¸‰æ–¹æ”¯ä»˜ç³»çµ±ä¸‹å–®æ¥å£ï¼Œé€™æ¨£å°±å³ä½¿æ²’æœ‰æ”¯ä»˜æˆåŠŸå°±ä¸æœƒå‡ºç¾ä¸Šé‚Šçš„å•é¡Œã€‚&lt;/p&gt;
&lt;p&gt;3ã€éœ€è¦æé†’ç”¨æˆ¶ä¸è¦é‡è¤‡ä»˜æ¬¾ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç·¨å¯«å»ºç«‹æ”¯ä»˜äº¤æ˜“è¨˜éŒ„çš„æ–¹æ³•ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; XcPayRecord &lt;span class=&#34;title function_&#34;&gt;createPayRecord&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(XcOrders orders)&lt;/span&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(order==&lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;)&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;è®¢å•ä¸å­˜åœ¨&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(orders.getStatus().equals(&lt;span class=&#34;string&#34;&gt;&amp;quot;600002&amp;quot;&lt;/span&gt;))&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;è®¢å•å·²æ”¯ä»˜&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;XcPayRecord&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payRecord&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;XcPayRecord&lt;/span&gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//ç”Ÿæˆæ”¯ä»˜äº¤æ˜“æµæ°´å· &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payNo&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; IdWorkerUtils.getInstance().nextId(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payRecord.setPayNo(payNo); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payRecord.setOrderId(orders.getId());&lt;span class=&#34;comment&#34;&gt;//å•†å“è®¢å•å· &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payRecord.setOrderName(orders.getOrderName()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payRecord.setTotalPrice(orders.getTotalPrice()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payRecord.setCurrency(&lt;span class=&#34;string&#34;&gt;&amp;quot;CNY&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payRecord.setCreateDate(LocalDateTime.now()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payRecord.setStatus(&lt;span class=&#34;string&#34;&gt;&amp;quot;601001&amp;quot;&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//æœªæ”¯ä»˜ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payRecord.setUserId(orders.getUserId()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payRecordMapper.insert(payRecord); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; payRecord; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;ç”¢æˆæ”¯ä»˜äºŒç¶­ç¢¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ç”¢æˆæ”¯ä»˜äºŒç¶­ç¢¼&#34;&gt;#&lt;/a&gt; ç”¢æˆæ”¯ä»˜äºŒç¶­ç¢¼&lt;/h2&gt;
&lt;p&gt;1ã€åœ¨ nacos ä¸­ orders-service-dev.yaml é…ç½®äºŒç¶­ç¢¼çš„ url&lt;/p&gt;
&lt;figure class=&#34;highlight yaml&#34;&gt;&lt;figcaption&gt;&lt;span&gt;YAML&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attr&#34;&gt;pay:&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;attr&#34;&gt;qrcodeurl:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;http://192.168.101.1/api/orders/requestpay?payNo=%s&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;2ã€ç”¨ format æ‹¼æ¥æ”¯ä»˜ URL, å®Œå–„å»ºç«‹è¨‚å–® service æ–¹æ³•:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Value(&amp;quot;$&amp;#123;pay.qrcodeurl&amp;#125;&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;String qrcodeurl; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Transactional&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; PayRecordDto &lt;span class=&#34;title function_&#34;&gt;createOrder&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String userId, AddOrderDto addOrderDto)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//åˆ›å»ºå•†å“è®¢å• &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;XcOrders&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;orders&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; saveXcOrders(userId, addOrderDto); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(orders==&lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;)&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;è®¢å•åˆ›å»ºå¤±è´¥&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(orders.getStatus().equals(&lt;span class=&#34;string&#34;&gt;&amp;quot;600002&amp;quot;&lt;/span&gt;))&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;è®¢å•å·²æ”¯ä»˜&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//ç”Ÿæˆæ”¯ä»˜è®°å½• &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;XcPayRecord&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payRecord&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; createPayRecord(orders); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//ç”ŸæˆäºŒç»´ç  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;qrCode&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//urlè¦å¯ä»¥è¢«æ¨¡æ‹Ÿå™¨è®¿é—®åˆ°ï¼Œurlä¸ºä¸‹å•æ¥å£(ç¨åå®šä¹‰) &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; String.format(qrcodeurl, payRecord.getPayNo()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        qrCode = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;QRCodeUtil&lt;/span&gt;().createQRCode(url, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (IOException e) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;ç”ŸæˆäºŒç»´ç å‡ºé”™&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;PayRecordDto&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payRecordDto&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;PayRecordDto&lt;/span&gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    BeanUtils.copyProperties(payRecord,payRecordDto); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payRecordDto.setQrcode(qrCode); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; payRecordDto; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;ç”ŸæˆäºŒç¶­ç¢¼æ¥å£å®Œå–„&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ç”ŸæˆäºŒç¶­ç¢¼æ¥å£å®Œå–„&#34;&gt;#&lt;/a&gt; ç”ŸæˆäºŒç¶­ç¢¼æ¥å£å®Œå–„&lt;/h2&gt;
&lt;p&gt;å®Œå–„ç”Ÿæˆæ”¯ä»˜äºŒç»´ç  controller æ¥å£&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Autowired&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;OrderService orderService; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@ApiOperation(&amp;quot;ç”Ÿæˆæ”¯ä»˜äºŒç»´ç &amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@PostMapping(&amp;quot;/generatepaycode&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@ResponseBody&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; PayRecordDto &lt;span class=&#34;title function_&#34;&gt;generatePayCode&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@RequestBody&lt;/span&gt; AddOrderDto addOrderDto)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//ç™»å½•ç”¨æˆ· &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    SecurityUtil.&lt;span class=&#34;type&#34;&gt;XcUser&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; SecurityUtil.getUser(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(user == &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;)&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;è¯·ç™»å½•åç»§ç»­é€‰è¯¾&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; orderService.createOrder(user.getId(), addOrderDto); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æˆäº†æ”¯ä»˜äºŒç¶­ç¢¼ï¼Œç”¨æˆ¶æƒç¢¼è«‹æ±‚ç¬¬ä¸‰æ–¹æ”¯ä»˜å¹³å°ä¸‹å–®ã€ä»˜æ¬¾ã€‚&lt;/p&gt;
&lt;p&gt;1. å®šç¾©æŸ¥è©¢æ”¯ä»˜äº¤æ˜“è¨˜éŒ„çš„ Service æ¥å£èˆ‡å¯¦ä½œæ–¹æ³•&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; XcPayRecord &lt;span class=&#34;title function_&#34;&gt;getPayRecordByPayno&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String payNo)&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¯¦ç¾å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; XcPayRecord &lt;span class=&#34;title function_&#34;&gt;getPayRecordByPayno&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String payNo)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;XcPayRecord&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;xcPayRecord&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; payRecordMapper.selectOne(&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;LambdaQueryWrapper&lt;/span&gt;&amp;lt;XcPayRecord&amp;gt;().eq(XcPayRecord::getPayNo, payNo)); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; xcPayRecord; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;2 å®šç¾©ä¸‹å–®æ¥å£å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Value(&amp;quot;$&amp;#123;pay.alipay.APP_ID&amp;#125;&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;String APP_ID; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Value(&amp;quot;$&amp;#123;pay.alipay.APP_PRIVATE_KEY&amp;#125;&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;String APP_PRIVATE_KEY; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Value(&amp;quot;$&amp;#123;pay.alipay.ALIPAY_PUBLIC_KEY&amp;#125;&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;String ALIPAY_PUBLIC_KEY; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@ApiOperation(&amp;quot;æ‰«ç ä¸‹å•æ¥å£&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@GetMapping(&amp;quot;/requestpay&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;requestpay&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String payNo,HttpServletResponse httpResponse)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; IOException &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//å¦‚æœpayNoä¸å­˜åœ¨åˆ™æç¤ºé‡æ–°å‘èµ·æ”¯ä»˜ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;XcPayRecord&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payRecord&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; orderService.getPayRecordByPayno(payNo); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(payRecord == &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;)&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;è¯·é‡æ–°ç‚¹å‡»æ”¯ä»˜è·å–äºŒç»´ç &amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜çŠ¶æ€ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;status&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; payRecord.getStatus(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;601002&amp;quot;&lt;/span&gt;.equals(status))&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;è®¢å•å·²æ”¯ä»˜ï¼Œè¯·å‹¿é‡å¤æ”¯ä»˜ã€‚&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//æ„é€ sdkçš„å®¢æˆ·ç«¯å¯¹è±¡ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;AlipayClient&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;client&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;DefaultAlipayClient&lt;/span&gt;(AlipayConfig.URL, APP_ID, APP_PRIVATE_KEY, AlipayConfig.FORMAT, AlipayConfig.CHARSET, ALIPAY_PUBLIC_KEY, AlipayConfig.SIGNTYPE);&lt;span class=&#34;comment&#34;&gt;//è·å¾—åˆå§‹åŒ–çš„AlipayClient &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;AlipayTradeWapPayRequest&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;alipayRequest&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;AlipayTradeWapPayRequest&lt;/span&gt;();&lt;span class=&#34;comment&#34;&gt;//åˆ›å»ºAPIå¯¹åº”çš„request &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//        alipayRequest.setReturnUrl(&amp;quot;http://domain.com/CallBack/return_url.jsp&amp;quot;); &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//        alipayRequest.setNotifyUrl(&amp;quot;http://tjxt-user-t.itheima.net/xuecheng/orders/paynotify&amp;quot;);//åœ¨å…¬å…±å‚æ•°ä¸­è®¾ç½®å›è·³å’Œé€šçŸ¥åœ°å€ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        alipayRequest.setBizContent(&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;#123;&amp;quot;&lt;/span&gt; + &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;string&#34;&gt;&amp;quot; \&amp;quot;out_trade_no\&amp;quot;:\&amp;quot;&amp;quot;&lt;/span&gt;+payRecord.getPayNo()+&lt;span class=&#34;string&#34;&gt;&amp;quot;\&amp;quot;,&amp;quot;&lt;/span&gt; + &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;string&#34;&gt;&amp;quot; \&amp;quot;total_amount\&amp;quot;:\&amp;quot;&amp;quot;&lt;/span&gt;+payRecord.getTotalPrice()+&lt;span class=&#34;string&#34;&gt;&amp;quot;\&amp;quot;,&amp;quot;&lt;/span&gt; + &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;string&#34;&gt;&amp;quot; \&amp;quot;subject\&amp;quot;:\&amp;quot;&amp;quot;&lt;/span&gt;+payRecord.getOrderName()+&lt;span class=&#34;string&#34;&gt;&amp;quot;\&amp;quot;,&amp;quot;&lt;/span&gt; + &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;string&#34;&gt;&amp;quot; \&amp;quot;product_code\&amp;quot;:\&amp;quot;QUICK_WAP_PAY\&amp;quot;&amp;quot;&lt;/span&gt; + &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;string&#34;&gt;&amp;quot; &amp;#125;&amp;quot;&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//å¡«å……ä¸šåŠ¡å‚æ•° &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;form&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//è¯·æ±‚æ”¯ä»˜å®ä¸‹å•æ¥å£,å‘èµ·httpè¯·æ±‚ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            form = client.pageExecute(alipayRequest).getBody(); &lt;span class=&#34;comment&#34;&gt;//è°ƒç”¨SDKç”Ÿæˆè¡¨å• &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (AlipayApiException e) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            e.printStackTrace(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        httpResponse.setContentType(&lt;span class=&#34;string&#34;&gt;&amp;quot;text/html;charset=&amp;quot;&lt;/span&gt; + AlipayConfig.CHARSET); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        httpResponse.getWriter().write(form);&lt;span class=&#34;comment&#34;&gt;//ç›´æ¥å°†å®Œæ•´çš„è¡¨å•htmlè¾“å‡ºåˆ°é¡µé¢ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        httpResponse.getWriter().flush(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        httpResponse.getWriter().close(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ”¯ä»˜æ¸¬è©¦&lt;br&gt;
æ¸¬è©¦æº–å‚™ï¼š&lt;/p&gt;
&lt;p&gt;1ã€å•Ÿå‹•ç¶²é—œæœå‹™ã€èªè­‰æœå‹™ã€é©—è­‰ç¢¼æœå‹™ã€å­¸ç¿’ä¸­å¿ƒæœå‹™ã€è¨‚å–®æœå‹™ã€å…§å®¹ç®¡ç†æœå‹™ã€‚&lt;/p&gt;
&lt;p&gt;2ã€ç™¼å¸ƒä¸€é–€æ”¶è²»èª²ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;3. ä½¿ç”¨è³‡æ–™ç›®éŒ„ä¸­çš„æ–°æ¨¡æ¿ course_template.ftl&lt;/p&gt;
&lt;p&gt;æ¸¬è©¦æµç¨‹ï¼š&lt;/p&gt;
&lt;p&gt;1. é€²å…¥æ”¶è²»èª²ç¨‹è©³ç´°é é¢ï¼Œé»é¸é¦¬ä¸Šå­¸ç¿’ã€‚&lt;/p&gt;
&lt;p&gt;2. è¿½è¹¤ç€è¦½å™¨åŠå¾®æœå‹™ï¼Œè§€å¯Ÿé¸èª²è¨˜éŒ„æ˜¯å¦å‰µå»ºæˆåŠŸã€å•†å“è¨‚å–®æ˜¯å¦å‰µå»ºæˆåŠŸã€æ”¯ä»˜äº¤æ˜“è¨˜éŒ„æ˜¯å¦å‰µå»ºæˆåŠŸã€‚&lt;/p&gt;
&lt;p&gt;3. è§€å¯Ÿç”¢ç”ŸäºŒç¶­ç¢¼æ˜¯å¦æˆåŠŸ&lt;/p&gt;
&lt;p&gt;4. ä½¿ç”¨æ¨¡æ“¬å™¨æƒç¢¼æ¸¬è©¦ï¼Œæ˜¯å¦å¯ä»¥æ­£å¸¸ä»˜æ¬¾ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æŸ¥è©¢ä»˜æ¬¾çµæœ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æŸ¥è©¢ä»˜æ¬¾çµæœ&#34;&gt;#&lt;/a&gt; æŸ¥è©¢ä»˜æ¬¾çµæœ&lt;/h2&gt;
&lt;p&gt;æ¥å£å®šä¹‰:&lt;/p&gt;
&lt;p&gt;æ ¹æ“šå‰é‚Šæˆ‘å€‘èª¿æŸ¥çš„ç²å–æ”¯ä»˜çµæœçš„æ¥å£ï¼ŒåŒ…æ‹¬ï¼šä¸»å‹•æŸ¥è©¢æ”¯ä»˜çµæœã€è¢«å‹•æ¥æ”¶æ”¯ä»˜çµæœã€‚&lt;br&gt;
é€™è£¡å…ˆå¯¦ç¾ä¸»å‹•æŸ¥è©¢æ”¯ä»˜çµæœï¼Œç•¶æ”¯ä»˜å®Œæˆç”¨æˆ¶é»æ“Šã€Œæ”¯ä»˜çµæœã€å°‡è«‹æ±‚ç¬¬ä¸‰æ–¹æ”¯ä»˜å¹³å°æŸ¥è©¢æ”¯ä»˜çµæœã€‚&lt;br&gt;
åœ¨ OrderController é¡åˆ¥ä¸­å®šç¾©æ¥å£å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@ApiOperation(&amp;quot;æŸ¥è¯¢æ”¯ä»˜ç»“æœ&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@GetMapping(&amp;quot;/payresult&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@ResponseBody&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; PayRecordDto &lt;span class=&#34;title function_&#34;&gt;payresult&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String payNo)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; IOException &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æŸ¥è¯¢æ”¯ä»˜ç»“æœ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;1ã€å®šç¾©æŸ¥è©¢æ”¯ä»˜çµæœçš„ service&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/** &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * è¯·æ±‚æ”¯ä»˜å®æŸ¥è¯¢æ”¯ä»˜ç»“æœ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * &lt;span class=&#34;doctag&#34;&gt;@param&lt;/span&gt; payNo æ”¯ä»˜è®°å½•id &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * &lt;span class=&#34;doctag&#34;&gt;@return&lt;/span&gt; æ”¯ä»˜è®°å½•ä¿¡æ¯ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; */&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; PayRecordDto &lt;span class=&#34;title function_&#34;&gt;queryPayResult&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String payNo)&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;2ã€service å®ç°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; PayRecordDto &lt;span class=&#34;title function_&#34;&gt;queryPayResult&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String payNo)&lt;/span&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;XcPayRecord&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payRecord&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; getPayRecordByPayno(payNo); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (payRecord == &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;è¯·é‡æ–°ç‚¹å‡»æ”¯ä»˜è·å–äºŒç»´ç &amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜çŠ¶æ€ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;status&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; payRecord.getStatus(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//å¦‚æœæ”¯ä»˜æˆåŠŸç›´æ¥è¿”å› &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;string&#34;&gt;&amp;quot;601002&amp;quot;&lt;/span&gt;.equals(status)) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;PayRecordDto&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payRecordDto&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;PayRecordDto&lt;/span&gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        BeanUtils.copyProperties(payRecord, payRecordDto); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; payRecordDto; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//ä»æ”¯ä»˜å®æŸ¥è¯¢æ”¯ä»˜ç»“æœ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;PayStatusDto&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payStatusDto&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; queryPayResultFromAlipay(payNo); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//ä¿å­˜æ”¯ä»˜ç»“æœ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    currentProxy.saveAliPayStatus( payStatusDto); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//é‡æ–°æŸ¥è¯¢æ”¯ä»˜è®°å½• &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payRecord = getPayRecordByPayno(payNo); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;PayRecordDto&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payRecordDto&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;PayRecordDto&lt;/span&gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    BeanUtils.copyProperties(payRecord, payRecordDto); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; payRecordDto; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å®šä¹‰ä»æ”¯ä»˜å®æŸ¥è¯¢æ”¯ä»˜ç»“æœçš„æ–¹æ³•&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; PayStatusDto &lt;span class=&#34;title function_&#34;&gt;queryPayResultFromAlipay&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String payNo)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//========è¯·æ±‚æ”¯ä»˜å®æŸ¥è¯¢æ”¯ä»˜ç»“æœ============= &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;AlipayClient&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;alipayClient&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;DefaultAlipayClient&lt;/span&gt;(AlipayConfig.URL, APP_ID, APP_PRIVATE_KEY, &lt;span class=&#34;string&#34;&gt;&amp;quot;json&amp;quot;&lt;/span&gt;, AlipayConfig.CHARSET, ALIPAY_PUBLIC_KEY, AlipayConfig.SIGNTYPE); &lt;span class=&#34;comment&#34;&gt;//è·å¾—åˆå§‹åŒ–çš„AlipayClient &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;AlipayTradeQueryRequest&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;request&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;AlipayTradeQueryRequest&lt;/span&gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;JSONObject&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;bizContent&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;JSONObject&lt;/span&gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    bizContent.put(&lt;span class=&#34;string&#34;&gt;&amp;quot;out_trade_no&amp;quot;&lt;/span&gt;, payNo); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    request.setBizContent(bizContent.toString()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;AlipayTradeQueryResponse&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        response = alipayClient.execute(request); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!response.isSuccess()) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;è¯·æ±‚æ”¯ä»˜æŸ¥è¯¢æŸ¥è¯¢å¤±è´¥&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (AlipayApiException e) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        log.error(&lt;span class=&#34;string&#34;&gt;&amp;quot;è¯·æ±‚æ”¯ä»˜å®æŸ¥è¯¢æ”¯ä»˜ç»“æœå¼‚å¸¸:&amp;#123;&amp;#125;&amp;quot;&lt;/span&gt;, e.toString(), e); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;è¯·æ±‚æ”¯ä»˜æŸ¥è¯¢æŸ¥è¯¢å¤±è´¥&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//è·å–æ”¯ä»˜ç»“æœ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;resultJson&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; response.getBody(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//è½¬map &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;Map&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;resultMap&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; JSON.parseObject(resultJson, Map.class); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;Map&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;alipay_trade_query_response&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; (Map) resultMap.get(&lt;span class=&#34;string&#34;&gt;&amp;quot;alipay_trade_query_response&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜ç»“æœ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;trade_status&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; (String) alipay_trade_query_response.get(&lt;span class=&#34;string&#34;&gt;&amp;quot;trade_status&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;total_amount&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; (String) alipay_trade_query_response.get(&lt;span class=&#34;string&#34;&gt;&amp;quot;total_amount&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;trade_no&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; (String) alipay_trade_query_response.get(&lt;span class=&#34;string&#34;&gt;&amp;quot;trade_no&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//ä¿å­˜æ”¯ä»˜ç»“æœ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;PayStatusDto&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payStatusDto&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;PayStatusDto&lt;/span&gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payStatusDto.setOut_trade_no(payNo); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payStatusDto.setTrade_status(trade_status); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payStatusDto.setApp_id(APP_ID); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payStatusDto.setTrade_no(trade_no); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payStatusDto.setTotal_amount(total_amount); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; payStatusDto; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;1ã€å®šä¹‰ä¿å­˜æ”¯ä»˜ç»“æœçš„æ¥å£&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;saveAliPayStatus&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(PayStatusDto payStatusDto)&lt;/span&gt; ;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;2ã€ç¼–å†™æ¥å£å®ç°&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Transactional&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;saveAliPayStatus&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(PayStatusDto payStatusDto)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜æµæ°´å· &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payNo&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; payStatusDto.getOut_trade_no(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;XcPayRecord&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payRecord&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; getPayRecordByPayno(payNo); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (payRecord == &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ”¯ä»˜è®°å½•æ‰¾ä¸åˆ°&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜ç»“æœ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;trade_status&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; payStatusDto.getTrade_status(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    log.debug(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ”¶åˆ°æ”¯ä»˜ç»“æœ:&amp;#123;&amp;#125;,æ”¯ä»˜è®°å½•:&amp;#123;&amp;#125;&amp;#125;&amp;quot;&lt;/span&gt;, payStatusDto.toString(),payRecord.toString()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (trade_status.equals(&lt;span class=&#34;string&#34;&gt;&amp;quot;TRADE_SUCCESS&amp;quot;&lt;/span&gt;)) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜é‡‘é¢å˜ä¸ºåˆ† &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;Float&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;totalPrice&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; payRecord.getTotalPrice() * &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;Float&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;total_amount&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; Float.parseFloat(payStatusDto.getTotal_amount()) * &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//æ ¡éªŒæ˜¯å¦ä¸€è‡´ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!payStatusDto.getApp_id().equals(APP_ID) || totalPrice.intValue() != total_amount.intValue()) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//æ ¡éªŒå¤±è´¥ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            log.info(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ ¡éªŒæ”¯ä»˜ç»“æœå¤±è´¥,æ”¯ä»˜è®°å½•:&amp;#123;&amp;#125;,APP_ID:&amp;#123;&amp;#125;,totalPrice:&amp;#123;&amp;#125;&amp;quot;&lt;/span&gt; ,payRecord.toString(),payStatusDto.getApp_id(),total_amount.intValue()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ ¡éªŒæ”¯ä»˜ç»“æœå¤±è´¥&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        log.debug(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ›´æ–°æ”¯ä»˜ç»“æœ,æ”¯ä»˜äº¤æ˜“æµæ°´å·:&amp;#123;&amp;#125;,æ”¯ä»˜ç»“æœ:&amp;#123;&amp;#125;&amp;quot;&lt;/span&gt;, payNo, trade_status); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;XcPayRecord&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payRecord_u&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;XcPayRecord&lt;/span&gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        payRecord_u.setStatus(&lt;span class=&#34;string&#34;&gt;&amp;quot;601002&amp;quot;&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜æˆåŠŸ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        payRecord_u.setOutPayChannel(&lt;span class=&#34;string&#34;&gt;&amp;quot;Alipay&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        payRecord_u.setOutPayNo(payStatusDto.getTrade_no());&lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜å®äº¤æ˜“å· &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        payRecord_u.setPaySuccessTime(LocalDateTime.now());&lt;span class=&#34;comment&#34;&gt;//é€šçŸ¥æ—¶é—´ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;update1&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; payRecordMapper.update(payRecord_u, &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;LambdaQueryWrapper&lt;/span&gt;&amp;lt;XcPayRecord&amp;gt;().eq(XcPayRecord::getPayNo, payNo)); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (update1 &amp;gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            log.info(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ›´æ–°æ”¯ä»˜è®°å½•çŠ¶æ€æˆåŠŸ:&amp;#123;&amp;#125;&amp;quot;&lt;/span&gt;, payRecord_u.toString()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            log.info(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ›´æ–°æ”¯ä»˜è®°å½•çŠ¶æ€å¤±è´¥:&amp;#123;&amp;#125;&amp;quot;&lt;/span&gt;, payRecord_u.toString()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ›´æ–°æ”¯ä»˜è®°å½•çŠ¶æ€å¤±è´¥&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//å…³è”çš„è®¢å•å· &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;Long&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;orderId&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; payRecord.getOrderId(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;XcOrders&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;orders&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; ordersMapper.selectById(orderId); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (orders == &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            log.info(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ ¹æ®æ”¯ä»˜è®°å½•[&amp;#123;&amp;#125;&amp;#125;]æ‰¾ä¸åˆ°è®¢å•&amp;quot;&lt;/span&gt;, payRecord_u.toString()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ ¹æ®æ”¯ä»˜è®°å½•æ‰¾ä¸åˆ°è®¢å•&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;XcOrders&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;order_u&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;XcOrders&lt;/span&gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        order_u.setStatus(&lt;span class=&#34;string&#34;&gt;&amp;quot;600002&amp;quot;&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜æˆåŠŸ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;update&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; ordersMapper.update(order_u, &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;LambdaQueryWrapper&lt;/span&gt;&amp;lt;XcOrders&amp;gt;().eq(XcOrders::getId, orderId)); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (update &amp;gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            log.info(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ›´æ–°è®¢å•è¡¨çŠ¶æ€æˆåŠŸ,è®¢å•å·:&amp;#123;&amp;#125;&amp;quot;&lt;/span&gt;, orderId); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            log.info(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ›´æ–°è®¢å•è¡¨çŠ¶æ€å¤±è´¥,è®¢å•å·:&amp;#123;&amp;#125;&amp;quot;&lt;/span&gt;, orderId); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ›´æ–°è®¢å•è¡¨çŠ¶æ€å¤±è´¥&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&#34;æ¥å£æ¸¬è©¦-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ¥å£æ¸¬è©¦-2&#34;&gt;#&lt;/a&gt; æ¥å£æ¸¬è©¦&lt;/h1&gt;
&lt;p&gt;1ã€å®Œå–„æ¥å£&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@ApiOperation(&amp;quot;æŸ¥è¯¢æ”¯ä»˜ç»“æœ&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@GetMapping(&amp;quot;/payresult&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@ResponseBody&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; PayRecordDto &lt;span class=&#34;title function_&#34;&gt;payresult&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(String payNo)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; IOException &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//è°ƒç”¨æ”¯ä»˜å®æ¥å£æŸ¥è¯¢ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;PayRecordDto&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payRecordDto&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; orderService.queryPayResult(payNo); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; payRecordDto; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å°å…¥é»‘é¦¬æä¾›çš„ LocalDateTimeConfig.java åˆ° base å·¥ç¨‹çš„ config åŒ…ä¸‹ï¼Œç”¨æ–¼è™•ç†å‰ç«¯ Long ç²¾åº¦éºå¤±çš„å•é¡Œï¼Œç„¶å¾Œä½¿ç”¨å‰å¾Œç«¯è¯èª¿&lt;/p&gt;
&lt;h2 id=&#34;æ¥æ”¶æ”¯ä»˜é€šçŸ¥&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ¥æ”¶æ”¯ä»˜é€šçŸ¥&#34;&gt;#&lt;/a&gt; æ¥æ”¶æ”¯ä»˜é€šçŸ¥&lt;/h2&gt;
&lt;p&gt;æ¥å£å®šä¹‰&lt;br&gt;
æ”¯ä»˜å®Œæˆåç¬¬ä¸‰æ–¹æ”¯ä»˜ç³»ç»Ÿä¼šä¸»åŠ¨é€šçŸ¥æ”¯ä»˜ç»“æœï¼Œè¦å®ç°ä¸»åŠ¨é€šçŸ¥éœ€è¦åœ¨è¯·æ±‚æ”¯ä»˜ç³»ç»Ÿä¸‹å•æ—¶ä¼ å…¥ NotifyUrlï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ª urlï¼šNotifyUrl å’Œ ReturnUrlï¼ŒReturnUrl æ˜¯æ”¯ä»˜å®Œæˆåæ”¯ä»˜ç³»ç»Ÿæºå¸¦æ”¯ä»˜ç»“æœé‡å®šå‘åˆ° ReturnUrl åœ°å€ï¼ŒNotifyUrl æ˜¯æ”¯ä»˜å®Œæˆåæ”¯ä»˜ç³»ç»Ÿåœ¨åå°å®šæ—¶å»é€šçŸ¥ï¼Œä½¿ç”¨ NotifyUrl æ¯”ä½¿ç”¨ ReturnUrl æœ‰ä¿è¯ã€‚&lt;/p&gt;
&lt;p&gt;æ ¹æ®æ¥å£æè¿°ï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9vcGVuZG9jcy5hbGlwYXkuY29tL29wZW4vMjAzLzEwNTI4NiVFNyU5QSU4NCVFNSU4NiU4NSVFNSVBRSVCOSVFNCVCOCU4QiVFOCVCRSVCOSVFNSU5QyVBOCVFOCVBRSVBMiVFNSU4RCU5NSVFNiU5QyU4RCVFNSU4QSVBMSVFNSVBRSU5QSVFNCVCOSU4OSVFNiU4RSVBNSVFNiU5NCVCNiVFNiU5NCVBRiVFNCVCQiU5OCVFNyVCQiU5MyVFNiU5RSU5QyVFOSU4MCU5QSVFNyU5RiVBNSVFNyU5QSU4NCVFNiU4RSVBNSVFNSU4RiVBMyVFMyU4MCU4Mg==&#34;&gt;https://opendocs.alipay.com/open/203/105286 çš„å†…å®¹ä¸‹è¾¹åœ¨è®¢å•æœåŠ¡å®šä¹‰æ¥æ”¶æ”¯ä»˜ç»“æœé€šçŸ¥çš„æ¥å£ã€‚&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆåœ¨ä¸‹å•æ—¶æŒ‡å®š NotifyUrl:&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;alipayRequest.setNotifyUrl(&lt;span class=&#34;string&#34;&gt;&amp;quot;http://tjxt-user-t.itheima.net/xuecheng/orders/receivenotify&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ¥æ”¶æ”¯ä»˜ç»“æœé€šçŸ¥æ¥å£å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@ApiOperation(&amp;quot;æ¥æ”¶æ”¯ä»˜ç»“æœé€šçŸ¥&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@PostMapping(&amp;quot;/receivenotify&amp;quot;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;receivenotify&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(HttpServletRequest request)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; UnsupportedEncodingException, AlipayApiException &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Map&amp;lt;String,String&amp;gt; params = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;HashMap&lt;/span&gt;&amp;lt;String,String&amp;gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;Map&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;requestParams&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; request.getParameterMap(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;Iterator&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;iter&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; requestParams.keySet().iterator(); iter.hasNext();) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; (String) iter.next(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        String[] values = (String[]) requestParams.get(name); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;valueStr&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; values.length; i++) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            valueStr = (i == values.length - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;) ? valueStr + values[i] &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    : valueStr + values[i] + &lt;span class=&#34;string&#34;&gt;&amp;quot;,&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        params.put(name, valueStr); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//éªŒç­¾ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;verify_result&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; AlipaySignature.rsaCheckV1(params, ALIPAY_PUBLIC_KEY, AlipayConfig.CHARSET, &lt;span class=&#34;string&#34;&gt;&amp;quot;RSA2&amp;quot;&lt;/span&gt;);  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(verify_result) &amp;#123;&lt;span class=&#34;comment&#34;&gt;//éªŒè¯æˆåŠŸ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//å•†æˆ·è®¢å•å· &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;out_trade_no&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;String&lt;/span&gt;(request.getParameter(&lt;span class=&#34;string&#34;&gt;&amp;quot;out_trade_no&amp;quot;&lt;/span&gt;).getBytes(&lt;span class=&#34;string&#34;&gt;&amp;quot;ISO-8859-1&amp;quot;&lt;/span&gt;),&lt;span class=&#34;string&#34;&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜å®äº¤æ˜“å· &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;trade_no&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;String&lt;/span&gt;(request.getParameter(&lt;span class=&#34;string&#34;&gt;&amp;quot;trade_no&amp;quot;&lt;/span&gt;).getBytes(&lt;span class=&#34;string&#34;&gt;&amp;quot;ISO-8859-1&amp;quot;&lt;/span&gt;),&lt;span class=&#34;string&#34;&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//äº¤æ˜“çŠ¶æ€ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;trade_status&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;String&lt;/span&gt;(request.getParameter(&lt;span class=&#34;string&#34;&gt;&amp;quot;trade_status&amp;quot;&lt;/span&gt;).getBytes(&lt;span class=&#34;string&#34;&gt;&amp;quot;ISO-8859-1&amp;quot;&lt;/span&gt;),&lt;span class=&#34;string&#34;&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//appid &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;app_id&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;String&lt;/span&gt;(request.getParameter(&lt;span class=&#34;string&#34;&gt;&amp;quot;app_id&amp;quot;&lt;/span&gt;).getBytes(&lt;span class=&#34;string&#34;&gt;&amp;quot;ISO-8859-1&amp;quot;&lt;/span&gt;),&lt;span class=&#34;string&#34;&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//total_amount &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;total_amount&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;String&lt;/span&gt;(request.getParameter(&lt;span class=&#34;string&#34;&gt;&amp;quot;total_amount&amp;quot;&lt;/span&gt;).getBytes(&lt;span class=&#34;string&#34;&gt;&amp;quot;ISO-8859-1&amp;quot;&lt;/span&gt;),&lt;span class=&#34;string&#34;&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;);  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//äº¤æ˜“æˆåŠŸå¤„ç† &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (trade_status.equals(&lt;span class=&#34;string&#34;&gt;&amp;quot;TRADE_SUCCESS&amp;quot;&lt;/span&gt;)) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;type&#34;&gt;PayStatusDto&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;payStatusDto&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;PayStatusDto&lt;/span&gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            payStatusDto.setOut_trade_no(out_trade_no); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            payStatusDto.setTrade_status(trade_status); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            payStatusDto.setApp_id(app_id); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            payStatusDto.setTrade_no(trade_no); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            payStatusDto.setTotal_amount(total_amount); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;           &lt;span class=&#34;comment&#34;&gt;//å¤„ç†é€»è¾‘ã€‚ã€‚ã€‚ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            orderService.saveAliPayStatus(payStatusDto); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ¥å£æµ‹è¯•:&lt;/p&gt;
&lt;p&gt;1ã€å¯åŠ¨ç½‘å…³æœåŠ¡ã€è®¤è¯æœåŠ¡ã€éªŒè¯ç æœåŠ¡ã€å­¦ä¹ ä¸­å¿ƒæœåŠ¡ã€å†…å®¹ç®¡ç†æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;2ã€å‘å¸ƒä¸€é—¨æ”¶è´¹è¯¾ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;æµ‹è¯•æµç¨‹ï¼š&lt;/p&gt;
&lt;p&gt;1ã€å¯¹é€‰è¯¾è¿›è¡Œæ”¯ä»˜&lt;/p&gt;
&lt;p&gt;2ã€æ”¯ä»˜æˆåŠŸè·Ÿè¸ª service æ–¹æ³•çš„æ—¥å¿—ï¼Œæ”¯ä»˜æˆåŠŸéœ€è¦æ›´æ–°æ”¯ä»˜äº¤æ˜“è¡¨è®°å½•çš„çŠ¶æ€ã€é€šçŸ¥æ—¶é—´ã€æ”¯ä»˜å®äº¤æ˜“å·ã€æ”¯ä»˜æ¸ é“ (Alipay)&lt;/p&gt;
&lt;p&gt;æ”¯ä»˜æˆåŠŸæ›´æ–°è®¢å•è¡¨çš„çŠ¶æ€ä¸ºç©ºã€‚&lt;/p&gt;
&lt;h1 id=&#34;æ”¯ä»˜é€šçŸ¥&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ”¯ä»˜é€šçŸ¥&#34;&gt;#&lt;/a&gt; æ”¯ä»˜é€šçŸ¥&lt;/h1&gt;
&lt;p&gt;è¨‚å–®æœå‹™ä½œç‚ºé€šç”¨æœå‹™åœ¨è¨‚å–®æ”¯ä»˜æˆåŠŸå¾Œéœ€è¦å°‡æ”¯ä»˜çµæœéåŒæ­¥é€šçŸ¥çµ¦å…¶å®ƒå¾®æœå‹™ã€‚&lt;br&gt;
ä¸‹åœ–ä½¿ç”¨äº†è¨Šæ¯éšŠåˆ—å®Œæˆæ”¯ä»˜çµæœé€šçŸ¥ï¼š&lt;/p&gt;
&lt;img data-src=&#34;/John/img/java/pay/alipay/8.png&#34; class=&#34;abc&#34;&gt;
&lt;p&gt;å­¸ç¿’ä¸­å¿ƒæœå‹™ï¼šæ”¶è²»èª²ç¨‹é¸èª²éœ€æ”¯ä»˜ï¼Œèˆ‡è¨‚å–®æœå‹™å°æ¥å®Œæˆæ”¯ä»˜ã€‚&lt;/p&gt;
&lt;p&gt;å­¸ç¿’è³‡æºæœå‹™ï¼šæ”¶è²»çš„å­¸ç¿’è³‡æ–™éœ€è¦è³¼è²·å¾Œä¸‹è¼‰ï¼Œèˆ‡è¨‚å–®æœå‹™å°æ¥å®Œæˆä»˜æ¬¾ã€‚&lt;/p&gt;
&lt;p&gt;è¨‚å–®æœå‹™å®Œæˆä»˜æ¬¾å¾Œå°‡ä»˜æ¬¾çµæœç™¼çµ¦æ¯ä¸€å€‹èˆ‡è¨‚å–®æœå‹™å°æ¥çš„å¾®æœå‹™ï¼Œè¨‚å–®æœå‹™å°‡è¨Šæ¯ç™¼çµ¦äº¤æ›æ©Ÿï¼Œç”±äº¤æ›æ©Ÿå»£æ’­è¨Šæ¯ï¼Œæ¯å€‹è¨‚é–±è¨Šæ¯çš„å¾®æœå‹™éƒ½å¯ä»¥æ¥æ”¶åˆ°æ”¯ä»˜çµæœ.&lt;/p&gt;
&lt;p&gt;å¾®æœå‹™æ”¶åˆ°ä»˜æ¬¾çµæœæœƒæ ¹æ“šè¨‚å–®çš„é¡å‹å»æ›´æ–°è‡ªå·±çš„æ¥­å‹™è³‡æ–™ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æŠ€æœ¯æ–¹æ¡ˆ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æŠ€æœ¯æ–¹æ¡ˆ&#34;&gt;#&lt;/a&gt; æŠ€æœ¯æ–¹æ¡ˆ&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨è¨Šæ¯éšŠåˆ—é€²è¡ŒéåŒæ­¥é€šçŸ¥éœ€è¦ä¿è­‰è¨Šæ¯çš„å¯é æ€§ï¼Œå³ç”Ÿç”¢ç«¯å°‡è¨Šæ¯æˆåŠŸé€šçŸ¥åˆ°æ¶ˆè²»ç«¯ã€‚&lt;br&gt;
è¨Šæ¯å¾ç”Ÿç”¢ç«¯ç™¼é€åˆ°æ¶ˆè²»ç«¯ç¶“æ­·ç­å¦‚ä¸‹éç¨‹ï¼š&lt;/p&gt;
&lt;p&gt;1ã€è¨Šæ¯ç™¼é€åˆ°äº¤æ›æ©Ÿ&lt;/p&gt;
&lt;p&gt;2ã€è¨Šæ¯ç”±äº¤æ›å™¨ç™¼é€åˆ°éšŠåˆ—&lt;/p&gt;
&lt;p&gt;3. è¨Šæ¯è€…æ”¶åˆ°è¨Šæ¯é€²è¡Œè™•ç†&lt;/p&gt;
&lt;p&gt;ä¿è­‰è¨Šæ¯çš„å¯é æ€§éœ€è¦ä¿è­‰ä»¥ä¸Šéç¨‹çš„å¯é æ€§ï¼Œæœ¬å°ˆæ¡ˆä½¿ç”¨ RabbitMQ å¯ä»¥é€éä»¥ä¸‹æ–¹é¢ä¿è­‰è¨Šæ¯çš„å¯é æ€§ã€‚&lt;/p&gt;
&lt;p&gt;1. ç”Ÿç”¢è€…ç¢ºèªæ©Ÿåˆ¶&lt;/p&gt;
&lt;p&gt;ç™¼é€è¨Šæ¯å‰ä½¿ç”¨è³‡æ–™åº«äº‹å‹™å°‡è¨Šæ¯ä¿è­‰åˆ°è³‡æ–™åº«è¡¨ä¸­&lt;br&gt;
æˆåŠŸå‚³é€åˆ°äº¤æ›å™¨å°‡è¨Šæ¯å¾è³‡æ–™åº«ä¸­åˆªé™¤&lt;/p&gt;
&lt;p&gt;2ã€mq æŒä¹…åŒ–&lt;/p&gt;
&lt;p&gt;mq æ”¶åˆ°è¨Šæ¯é€²è¡ŒæŒä¹…åŒ–ï¼Œç•¶ mq é‡å•Ÿå³ä½¿è¨Šæ¯æ²’æœ‰æ¶ˆè²»å®Œä¹Ÿä¸æœƒéºå¤±ã€‚&lt;br&gt;
éœ€è¦é…ç½®äº¤æ›å™¨æŒä¹…åŒ–ã€éšŠåˆ—æŒä¹…åŒ–ã€ç™¼é€è¨Šæ¯æ™‚è¨­å®šæŒä¹…åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;3. æ¶ˆè²»è€…ç¢ºèªæ©Ÿåˆ¶&lt;/p&gt;
&lt;p&gt;æ¶ˆè²»è€…æ¶ˆè²»æˆåŠŸè‡ªå‹•ç™¼é€ ackï¼Œå¦å‰‡é‡è©¦æ¶ˆè²»ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¨‚å–®æœå‹™æ•´åˆmq&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#è¨‚å–®æœå‹™æ•´åˆmq&#34;&gt;#&lt;/a&gt; è¨‚å–®æœå‹™æ•´åˆ MQ&lt;/h2&gt;
&lt;p&gt;1. é¦–å…ˆåœ¨è¨‚å–®æœå‹™æ–°å¢è¨Šæ¯éšŠåˆ—ä¾è³´&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;figcaption&gt;&lt;span&gt;XML&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-amqp&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;2. åœ¨ nacos é…ç½® rabbitmq-dev.yaml ç‚ºé€šç”¨é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;figure class=&#34;highlight yaml&#34;&gt;&lt;figcaption&gt;&lt;span&gt;YAML&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attr&#34;&gt;spring:&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;attr&#34;&gt;rabbitmq:&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;host:&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;192.168&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.101&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.65&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;port:&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;5672&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;username:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;guest&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;password:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;guest&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;virtual-host:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;/&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;publisher-confirm-type:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;correlated&lt;/span&gt; &lt;span class=&#34;comment&#34;&gt;#correlated å¼‚æ­¥å›è°ƒï¼Œå®šä¹‰ConfirmCallbackï¼ŒMQè¿”å›ç»“æœæ—¶ä¼šå›è°ƒè¿™ä¸ªConfirmCallback &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;publisher-returns:&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt; &lt;span class=&#34;comment&#34;&gt;#å¼€å¯publish-returnåŠŸèƒ½ï¼ŒåŒæ ·æ˜¯åŸºäºcallbackæœºåˆ¶ï¼Œéœ€è¦å®šä¹‰ReturnCallback &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;template:&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;attr&#34;&gt;mandatory:&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt; &lt;span class=&#34;comment&#34;&gt;#å®šä¹‰æ¶ˆæ¯è·¯ç”±å¤±è´¥æ—¶çš„ç­–ç•¥ã€‚trueï¼Œåˆ™è°ƒç”¨ReturnCallbackï¼›falseï¼šåˆ™ç›´æ¥ä¸¢å¼ƒæ¶ˆæ¯ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;listener:&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;attr&#34;&gt;simple:&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;attr&#34;&gt;acknowledge-mode:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;none&lt;/span&gt; &lt;span class=&#34;comment&#34;&gt;#å‡ºç°å¼‚å¸¸æ—¶è¿”å›unackï¼Œæ¶ˆæ¯å›æ»šåˆ°mqï¼›æ²¡æœ‰å¼‚å¸¸ï¼Œè¿”å›ack ,manual:æ‰‹åŠ¨æ§åˆ¶,none:ä¸¢å¼ƒæ¶ˆæ¯ï¼Œä¸å›æ»šåˆ°mq &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;attr&#34;&gt;retry:&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;attr&#34;&gt;enabled:&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt; &lt;span class=&#34;comment&#34;&gt;#å¼€å¯æ¶ˆè´¹è€…å¤±è´¥é‡è¯• &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;attr&#34;&gt;initial-interval:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;1000ms&lt;/span&gt; &lt;span class=&#34;comment&#34;&gt;#åˆè¯†çš„å¤±è´¥ç­‰å¾…æ—¶é•¿ä¸º1ç§’ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;attr&#34;&gt;multiplier:&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;comment&#34;&gt;#å¤±è´¥çš„ç­‰å¾…æ—¶é•¿å€æ•°ï¼Œä¸‹æ¬¡ç­‰å¾…æ—¶é•¿ = multiplier * last-interval &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;attr&#34;&gt;max-attempts:&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;comment&#34;&gt;#æœ€å¤§é‡è¯•æ¬¡æ•° &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;attr&#34;&gt;stateless:&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt; &lt;span class=&#34;comment&#34;&gt;#trueæ— çŠ¶æ€ï¼›falseæœ‰çŠ¶æ€ã€‚å¦‚æœä¸šåŠ¡ä¸­åŒ…å«äº‹åŠ¡ï¼Œè¿™é‡Œæ”¹ä¸ºfalse &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;`3. åœ¨è¨‚å–®æœå‹™éšŠåˆ—å·¥ç¨‹å¼•å…¥ rabbitmq-dev.yaml è¨­å®šæª”&lt;/p&gt;
&lt;figure class=&#34;highlight yaml&#34;&gt;&lt;figcaption&gt;&lt;span&gt;YAML&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attr&#34;&gt;shared-configs:&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;bullet&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;data-id:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;rabbitmq-$&amp;#123;spring.profiles.active&amp;#125;.yaml&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;group:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;xuecheng-plus-common&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;refresh:&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;4. åœ¨è¨‚å–®æœå‹™ service å·¥ç¨‹ç·¨å¯« MQ é…ç½®é¡ï¼Œé…ç½®äº¤æ›æ©Ÿ&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Slf4j&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Configuration&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;PayNotifyConfig&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;ApplicationContextAware&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//äº¤æ¢æœº &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;PAYNOTIFY_EXCHANGE_FANOUT&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;paynotify_exchange_fanout&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜ç»“æœé€šçŸ¥æ¶ˆæ¯ç±»å‹ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;MESSAGE_TYPE&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;payresult_notify&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜é€šçŸ¥éšŠåˆ— &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;PAYNOTIFY_QUEUE&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;paynotify_queue&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//å£°æ˜äº¤æ¢æœºï¼Œä¸”æŒä¹…åŒ– &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Bean(PAYNOTIFY_EXCHANGE_FANOUT)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; FanoutExchange &lt;span class=&#34;title function_&#34;&gt;paynotify_exchange_fanout&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// ä¸‰ä¸ªå‚æ•°ï¼šäº¤æ¢æœºåç§°ã€æ˜¯å¦æŒä¹…åŒ–ã€å½“æ²¡æœ‰queueä¸å…¶ç»‘å®šæ—¶æ˜¯å¦è‡ªåŠ¨åˆ é™¤ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;FanoutExchange&lt;/span&gt;(PAYNOTIFY_EXCHANGE_FANOUT, &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜é€šçŸ¥éšŠåˆ—,ä¸”æŒä¹…åŒ– &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Bean(PAYNOTIFY_QUEUE)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Queue &lt;span class=&#34;title function_&#34;&gt;course_publish_queue&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; QueueBuilder.durable(PAYNOTIFY_QUEUE).build(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//äº¤æ¢æœºå’Œæ”¯ä»˜é€šçŸ¥éšŠåˆ—ç»‘å®š &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Bean&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Binding &lt;span class=&#34;title function_&#34;&gt;binding_course_publish_queue&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@Qualifier(PAYNOTIFY_QUEUE)&lt;/span&gt; Queue queue, &lt;span class=&#34;meta&#34;&gt;@Qualifier(PAYNOTIFY_EXCHANGE_FANOUT)&lt;/span&gt; FanoutExchange exchange)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; BindingBuilder.bind(queue).to(exchange); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;setApplicationContext&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(ApplicationContext applicationContext)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; BeansException &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è·å–RabbitTemplate &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;RabbitTemplate&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;rabbitTemplate&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; applicationContext.getBean(RabbitTemplate.class); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//æ¶ˆæ¯å¤„ç†service &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;MqMessageService&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;mqMessageService&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; applicationContext.getBean(MqMessageService.class); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// è®¾ç½®ReturnCallback &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        rabbitTemplate.setReturnCallback((message, replyCode, replyText, exchange, routingKey) -&amp;gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;// æŠ•é€’å¤±è´¥ï¼Œè®°å½•æ—¥å¿— &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            log.info(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ¶ˆæ¯å‘é€å¤±è´¥ï¼Œåº”ç­”ç &amp;#123;&amp;#125;ï¼ŒåŸå› &amp;#123;&amp;#125;ï¼Œäº¤æ¢æœº&amp;#123;&amp;#125;ï¼Œè·¯ç”±é”®&amp;#123;&amp;#125;,æ¶ˆæ¯&amp;#123;&amp;#125;&amp;quot;&lt;/span&gt;, &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    replyCode, replyText, exchange, routingKey, message.toString()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;type&#34;&gt;MqMessage&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;mqMessage&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; JSON.parseObject(message.toString(), MqMessage.class); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//å°†æ¶ˆæ¯å†æ·»åŠ åˆ°æ¶ˆæ¯è¡¨ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            mqMessageService.addMessage(mqMessage.getMessageType(),mqMessage.getBusinessKey1(),mqMessage.getBusinessKey2(),mqMessage.getBusinessKey3()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;ç™¼é€æ”¯ä»˜çµæœ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ç™¼é€æ”¯ä»˜çµæœ&#34;&gt;#&lt;/a&gt; ç™¼é€æ”¯ä»˜çµæœ&lt;/h2&gt;
&lt;p&gt;åœ¨ OrderService ä¸­å®šä¹‰æ¥å£&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/** &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * å‘é€é€šçŸ¥ç»“æœ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * &lt;span class=&#34;doctag&#34;&gt;@param&lt;/span&gt; message &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; */&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;notifyPayResult&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(MqMessage message)&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç·¨å¯«æ¥å£å¯¦ä½œæ–¹æ³•ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;notifyPayResult&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(MqMessage message)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//1ã€æ¶ˆæ¯ä½“ï¼Œè½¬json &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;msg&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; JSON.toJSONString(message); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//è®¾ç½®æ¶ˆæ¯æŒä¹…åŒ– &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;Message&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;msgObj&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; MessageBuilder.withBody(msg.getBytes(StandardCharsets.UTF_8)) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            .setDeliveryMode(MessageDeliveryMode.PERSISTENT) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            .build(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 2.å…¨å±€å”¯ä¸€çš„æ¶ˆæ¯IDï¼Œéœ€è¦å°è£…åˆ°CorrelationDataä¸­ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;CorrelationData&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;correlationData&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;CorrelationData&lt;/span&gt;(message.getId().toString()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 3.æ·»åŠ callback &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    correlationData.getFuture().addCallback( &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            result -&amp;gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(result.isAck())&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;comment&#34;&gt;// 3.1.ackï¼Œæ¶ˆæ¯æˆåŠŸ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    log.debug(&lt;span class=&#34;string&#34;&gt;&amp;quot;é€šçŸ¥æ”¯ä»˜ç»“æœæ¶ˆæ¯å‘é€æˆåŠŸ, ID:&amp;#123;&amp;#125;&amp;quot;&lt;/span&gt;, correlationData.getId()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;comment&#34;&gt;//åˆ é™¤æ¶ˆæ¯è¡¨ä¸­çš„è®°å½• &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    mqMessageService.completed(message.getId()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;comment&#34;&gt;// 3.2.nackï¼Œæ¶ˆæ¯å¤±è´¥ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    log.error(&lt;span class=&#34;string&#34;&gt;&amp;quot;é€šçŸ¥æ”¯ä»˜ç»“æœæ¶ˆæ¯å‘é€å¤±è´¥, ID:&amp;#123;&amp;#125;, åŸå› &amp;#123;&amp;#125;&amp;quot;&lt;/span&gt;,correlationData.getId(), result.getReason()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;, &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            ex -&amp;gt; log.error(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ¶ˆæ¯å‘é€å¼‚å¸¸, ID:&amp;#123;&amp;#125;, åŸå› &amp;#123;&amp;#125;&amp;quot;&lt;/span&gt;,correlationData.getId(),ex.getMessage()) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å‘é€æ¶ˆæ¯ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    rabbitTemplate.convertAndSend(PayNotifyConfig.PAYNOTIFY_EXCHANGE_FANOUT, &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, msgObj,correlationData); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è®¢å•æœåŠ¡æ”¶åˆ°ç¬¬ä¸‰æ–¹å¹³å°çš„æ”¯ä»˜ç»“æœæ—¶ï¼Œåœ¨ saveAliPayStatus æ–¹æ³•ä¸­æ·»åŠ ä»£ç ï¼Œå‘æ•°æ®åº“æ¶ˆæ¯è¡¨æ·»åŠ æ¶ˆæ¯å¹¶è¿›è¡Œå‘é€æ¶ˆæ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Transactional&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Override&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;saveAliPayStatus&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(PayStatusDto payStatusDto)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ....... &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//ä¿å­˜æ¶ˆæ¯è®°å½•,å‚æ•°1ï¼šæ”¯ä»˜ç»“æœé€šçŸ¥ç±»å‹ï¼Œ2: ä¸šåŠ¡idï¼Œ3:ä¸šåŠ¡ç±»å‹ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;MqMessage&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;mqMessage&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; mqMessageService.addMessage(&lt;span class=&#34;string&#34;&gt;&amp;quot;payresult_notify&amp;quot;&lt;/span&gt;, orders.getOutBusinessId(), orders.getOrderType(), &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//é€šçŸ¥æ¶ˆæ¯ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        notifyPayResult(mqMessage); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;é…ç½®äº¤æ¢æœºå’ŒéšŠåˆ—&lt;/p&gt;
&lt;p&gt;åœ¨ order-service å·¥ç¨‹é…ç½®&lt;/p&gt;
&lt;p&gt;æ¶ˆæ¯å‘é€æ–¹æ³•&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/** &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * å‘é€é€šçŸ¥ç»“æœ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * &lt;span class=&#34;doctag&#34;&gt;@param&lt;/span&gt; message &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; */&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;notifyPayResult&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(MqMessage message)&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;å­¸ç¿’ä¸­å¿ƒæœå‹™é›†æˆmq&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å­¸ç¿’ä¸­å¿ƒæœå‹™é›†æˆmq&#34;&gt;#&lt;/a&gt; å­¸ç¿’ä¸­å¿ƒæœå‹™é›†æˆ MQ&lt;/h2&gt;
&lt;p&gt;1ã€åœ¨å­¦ä¹ ä¸­å¿ƒæœåŠ¡æ·»åŠ æ¶ˆæ¯éšŠåˆ—ä¾èµ–&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;figcaption&gt;&lt;span&gt;XML&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-amqp&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;2ã€åœ¨å­¦ä¹ ä¸­å¿ƒæœåŠ¡æ¥å£å·¥ç¨‹å¼•å…¥ rabbitmq-dev.yaml é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;figure class=&#34;highlight yaml&#34;&gt;&lt;figcaption&gt;&lt;span&gt;YAML&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attr&#34;&gt;shared-configs:&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;bullet&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;data-id:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;rabbitmq-$&amp;#123;spring.profiles.active&amp;#125;.yaml&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;group:&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;xuecheng-plus-common&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;attr&#34;&gt;refresh:&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;3ã€æ·»åŠ é…ç½®ç±»&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Slf4j&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Configuration&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;PayNotifyConfig&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//äº¤æ¢æœº &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;PAYNOTIFY_EXCHANGE_FANOUT&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;paynotify_exchange_fanout&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜ç»“æœé€šçŸ¥æ¶ˆæ¯ç±»å‹ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;MESSAGE_TYPE&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;payresult_notify&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜é€šçŸ¥éšŠåˆ— &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;PAYNOTIFY_QUEUE&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;paynotify_queue&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//å£°æ˜äº¤æ¢æœºï¼Œä¸”æŒä¹…åŒ– &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Bean(PAYNOTIFY_EXCHANGE_FANOUT)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; FanoutExchange &lt;span class=&#34;title function_&#34;&gt;paynotify_exchange_fanout&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;// ä¸‰ä¸ªå‚æ•°ï¼šäº¤æ¢æœºåç§°ã€æ˜¯å¦æŒä¹…åŒ–ã€å½“æ²¡æœ‰queueä¸å…¶ç»‘å®šæ—¶æ˜¯å¦è‡ªåŠ¨åˆ é™¤ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;FanoutExchange&lt;/span&gt;(PAYNOTIFY_EXCHANGE_FANOUT, &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//æ”¯ä»˜é€šçŸ¥éšŠåˆ—,ä¸”æŒä¹…åŒ– &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Bean(PAYNOTIFY_QUEUE)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Queue &lt;span class=&#34;title function_&#34;&gt;course_publish_queue&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; QueueBuilder.durable(PAYNOTIFY_QUEUE).build(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//äº¤æ¢æœºå’Œæ”¯ä»˜é€šçŸ¥éšŠåˆ—ç»‘å®š &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Bean&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Binding &lt;span class=&#34;title function_&#34;&gt;binding_course_publish_queue&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;meta&#34;&gt;@Qualifier(PAYNOTIFY_QUEUE)&lt;/span&gt; Queue queue, &lt;span class=&#34;meta&#34;&gt;@Qualifier(PAYNOTIFY_EXCHANGE_FANOUT)&lt;/span&gt; FanoutExchange exchange)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; BindingBuilder.bind(queue).to(exchange); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;æ¥æ”¶æ”¯ä»˜ç»“æœ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ¥æ”¶æ”¯ä»˜ç»“æœ&#34;&gt;#&lt;/a&gt; æ¥æ”¶æ”¯ä»˜ç»“æœ&lt;/h2&gt;
&lt;p&gt;ç›‘å¬ MQï¼Œæ¥æ”¶æ”¯ä»˜ç»“æœï¼Œå®šä¹‰ ReceivePayNotifyService ç±»å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Slf4j&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Service&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;ReceivePayNotifyService&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Autowired&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; RabbitTemplate rabbitTemplate; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Autowired&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    MqMessageService mqMessageService; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@Autowired&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    MyCourseTablesService myCourseTablesService; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//ç›‘å¬æ¶ˆæ¯éšŠåˆ—æ¥æ”¶æ”¯ä»˜ç»“æœé€šçŸ¥ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;meta&#34;&gt;@RabbitListener(queues = PayNotifyConfig.PAYNOTIFY_QUEUE)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;receive&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(Message message, Channel channel)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            Thread.sleep(&lt;span class=&#34;number&#34;&gt;5000&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;catch&lt;/span&gt; (InterruptedException e) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;RuntimeException&lt;/span&gt;(e); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//è·å–æ¶ˆæ¯ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;MqMessage&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;mqMessage&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; JSON.parseObject(message.getBody(), MqMessage.class); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        log.debug(&lt;span class=&#34;string&#34;&gt;&amp;quot;å­¦ä¹ ä¸­å¿ƒæœåŠ¡æ¥æ”¶æ”¯ä»˜ç»“æœ:&amp;#123;&amp;#125;&amp;quot;&lt;/span&gt;, mqMessage); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//æ¶ˆæ¯ç±»å‹ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;messageType&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; mqMessage.getMessageType(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//è®¢å•ç±»å‹,60201è¡¨ç¤ºè´­ä¹°è¯¾ç¨‹ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;businessKey2&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; mqMessage.getBusinessKey2(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//è¿™é‡Œåªå¤„ç†æ”¯ä»˜ç»“æœé€šçŸ¥ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (PayNotifyConfig.MESSAGE_TYPE.equals(messageType) &amp;amp;&amp;amp; &lt;span class=&#34;string&#34;&gt;&amp;quot;60201&amp;quot;&lt;/span&gt;.equals(businessKey2)) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//é€‰è¯¾è®°å½•id &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;choosecourseId&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; mqMessage.getBusinessKey1(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//æ·»åŠ é€‰è¯¾ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;type&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; myCourseTablesService.saveChooseCourseStauts(choosecourseId); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(!b)&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//æ·»åŠ é€‰è¯¾å¤±è´¥ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œæ¶ˆæ¯é‡å›éšŠåˆ— &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                XueChengPlusException.cast(&lt;span class=&#34;string&#34;&gt;&amp;quot;æ”¶åˆ°æ”¯ä»˜ç»“æœï¼Œæ·»åŠ é€‰è¯¾å¤±è´¥&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;é€šçŸ¥æ”¯ä»˜ç»“æœæ¸¬è©¦&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#é€šçŸ¥æ”¯ä»˜ç»“æœæ¸¬è©¦&#34;&gt;#&lt;/a&gt; é€šçŸ¥æ”¯ä»˜ç»“æœæ¸¬è©¦&lt;/h2&gt;
&lt;p&gt;æµ‹è¯•å‡†å¤‡ï¼š&lt;/p&gt;
&lt;p&gt;1ï¸âƒ£æ‰¾ä¸€é–€å·²ç™¼å¸ƒçš„æ”¶è²»èª²ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;2ï¸âƒ£å¦‚æœåœ¨æˆ‘çš„èª²ç¨‹è¡¨å„²å­˜å‰‡åˆªé™¤ã€‚&lt;/p&gt;
&lt;p&gt;3ï¸âƒ£åˆªé™¤æ­¤èª²ç¨‹çš„é¸èª²ç´€éŒ„åŠè¨‚å–®è³‡è¨Šã€‚&lt;/p&gt;
&lt;p&gt;æ¸¬è©¦æµç¨‹ï¼š&lt;/p&gt;
&lt;p&gt;1ï¸âƒ£é€²å…¥èª²ç¨‹è©³ç´°é é¢ï¼Œé»é¸é¦¬ä¸Šå­¸ç¿’ï¼Œç”¢ç”ŸäºŒç¶­ç¢¼é€²è¡Œä»˜æ¬¾ã€‚&lt;/p&gt;
&lt;p&gt;2ï¸âƒ£ä»˜æ¬¾å®Œæˆé»æ“Š â€œä»˜æ¬¾å®Œæˆâ€ï¼Œè§€å¯Ÿè¨‚å–®æœå‹™æ§åˆ¶å°æ˜¯å¦ç™¼é€è¨Šæ¯ã€‚&lt;/p&gt;
&lt;p&gt;3ï¸âƒ£è§€å¯Ÿå­¸ç¿’ä¸­å¿ƒæœå‹™æ§åˆ¶å°æ˜¯å¦æ¥æ”¶åˆ°è¨Šæ¯ã€‚&lt;/p&gt;
&lt;p&gt;4ï¸âƒ£è§€å¯Ÿè³‡æ–™åº«ä¸­çš„æ¶ˆæ¯è¡¨çš„ç›¸æ‡‰è¨˜éŒ„æ˜¯å¦å·²åˆªé™¤ã€‚&lt;/p&gt;
&lt;p&gt;æ¶ˆè²»é‡è©¦æ¸¬è©¦ï¼š&lt;/p&gt;
&lt;p&gt;1ï¸âƒ£åœ¨å­¸ç¿’ä¸­å¿ƒæœå‹™æ¥æ”¶æ”¯ä»˜çµæœæ–¹æ³•ä¸­è£½é€ ç•°å¸¸ã€‚&lt;/p&gt;
&lt;p&gt;2ï¸âƒ£é‡æ–°åŸ·è¡Œä¸Šé‚Šçš„æ¸¬è©¦æµç¨‹ï¼Œè§€å¯Ÿæ˜¯å¦æ¶ˆè²»é‡è©¦ã€‚&lt;/p&gt;
&lt;img data-src=&#34;https://usagif.com/wp-content/uploads/gifs/thanks-for-watching-9.gif&#34; class=&#34;abc&#34; width=&#34;600&#34; height=&#34;350&#34;&gt; ]]></description>
        </item>
    </channel>
</rss>
